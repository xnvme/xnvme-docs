<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; xNVMe 0.7.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=70f28cd9" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=c98573da"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tools" href="../tools/index.html" />
    <link rel="prev" title="Cross-platform libraries and tools for NVMe devices" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            xNVMe
          </a>
              <div class="version">
                0.7.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building-xnvme">Building xNVMe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#toolchain">Toolchain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#alpine-linux-latest">Alpine Linux (latest)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arch-linux-latest">Arch Linux (latest)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#oracle-linux-9-9">Oracle Linux 9 (9)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rocky-linux-9-2-9-2">Rocky Linux 9.2 (9.2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#centos-stream-9-stream9">CentOS Stream 9 (stream9)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debian-testing-trixie">Debian Testing (trixie)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debian-stable-bookworm">Debian Stable (bookworm)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debian-oldstable-bullseye">Debian Oldstable (bullseye)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fedora-38">Fedora (38)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fedora-37">Fedora (37)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fedora-36">Fedora (36)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ubuntu-latest-lunar">Ubuntu Latest (lunar)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ubuntu-lts-jammy">Ubuntu LTS (jammy)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ubuntu-lts-focal">Ubuntu LTS (focal)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gentoo-latest">Gentoo (latest)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#opensuse-tumbleweed-latest">openSUSE (tumbleweed-latest)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#freebsd-13">FreeBSD (13)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macos-13">macOS (13)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macos-12">macOS (12)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macos-11">macOS (11)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#windows-2022">Windows (2022)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#backends-and-system-config">Backends and System Config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#backends">Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kernel">Kernel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nvme-driver-and-ioctls">NVMe Driver and IOCTLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#block-layer">Block Layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#block-zoned-ioctls">Block Zoned IOCTLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#async-i-o-via-libaio">Async I/O via <code class="docutils literal notranslate"><span class="pre">libaio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#async-i-o-via-io-uring">Async. I/O via <code class="docutils literal notranslate"><span class="pre">io_uring</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#user-space">User Space</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#config">Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unbinding-and-binding">Unbinding and binding</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-identifiers">Device Identifiers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#windows-kernel">Windows Kernel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">NVMe Driver and IOCTLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvme-driver-and-regular-file">NVMe Driver and Regular File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#async-i-o-via-iocp">Async I/O via <code class="docutils literal notranslate"><span class="pre">iocp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#async-i-o-via-iocp-th">Async I/O via <code class="docutils literal notranslate"><span class="pre">iocp_th</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#async-i-o-via-io-ring">Async I/O via <code class="docutils literal notranslate"><span class="pre">io_ring</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-spdk-backend-on-windows">Building SPDK backend on Windows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites-to-compile-the-spdk">Prerequisite’s to compile the <code class="docutils literal notranslate"><span class="pre">SPDK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#compilation-and-installation">Compilation and Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#runtime-prerequisites">Runtime Prerequisite’s</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-an-xnvme-program">Building an xNVMe Program</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-code">Example code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compile-and-link">Compile and link</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run">Run!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">User space</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#no-devices-found">No devices found</a></li>
<li class="toctree-l4"><a class="reference internal" href="#memory-issues">Memory Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#build-errors">Build Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#known-build-issues">Known Build Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#customizing-the-build">Customizing the Build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#non-gcc-toolchain">Non-GCC Toolchain</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-configuration">Custom Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-compiling-for-arm-on-x86">Cross-compiling for ARM on x86</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../capis/index.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">C API: Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compatibility/index.html">Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci/index.html">CI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">xNVMe</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/getting_started/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<span id="sec-getting-started"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h1>
<p>Previously a <strong>quick start</strong> guide was available. However, it usually left one
asking questions, and thus, did not as the name suggests; get you started
quickly. Thus, a fuller story on getting started using <strong>xNVMe</strong> is provided
here.  Needlessly, this section will have subsections that you can skip and
revisit only in case you find <strong>xNVMe</strong>, or the system you are running on, to
be misbehaving.</p>
<p>If you have read through, and still have questions, then please raise an
<a class="reference external" href="https://github.com/OpenMPDK/xNVMe/issues">issue</a>, start an asynchronous <a class="reference external" href="https://github.com/OpenMPDK/xNVMe/discussions">discussion</a>, or go to <a class="reference external" href="https://discord.com/invite/XCbBX9DmKf">Discord</a> for synchronous
interaction.</p>
<p>The task of getting started with <strong>xNVMe</strong> will take you through
<a class="reference internal" href="#sec-building"><span class="std std-ref">Building xNVMe</span></a> with a companion section on <a class="reference internal" href="toolchain.html#sec-building-toolchain"><span class="std std-ref">Toolchain</span></a>
prerequisites, followed by a section describing runtime requirements in
<a class="reference internal" href="#sec-gs-system-config"><span class="std std-ref">Backends and System Config</span></a>, ending with an example of
<a class="reference internal" href="#sec-building-example"><span class="std std-ref">Windows Kernel</span></a>.</p>
<section id="building-xnvme">
<span id="sec-building"></span><h2>Building xNVMe<a class="headerlink" href="#building-xnvme" title="Link to this heading"></a></h2>
<p><strong>xNVMe</strong> builds and runs on Linux, FreeBSD and Windows. First, retrieve the
<strong>xNVMe</strong> repository from  <a class="reference external" href="https://github.com/OpenMPDK/xNVMe">GitHUB</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clone the xNVMe repos into the folder &#39;xnvme&#39;</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/xNVMe.git<span class="w"> </span>xnvme
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The xNVMe build-system uses <code class="docutils literal notranslate"><span class="pre">meson/ninja</span></code> and its
subproject-feature with wraps, dependencies such as fio, libvfn, and SPDK
are fetched by the build-system (meson), not as previously done via
git-submodules.</p>
</div>
<p>Before you invoke the compilation, then ensure that you have the compiler,
tools, and libraries needed. The <a class="reference internal" href="toolchain.html#sec-building-toolchain"><span class="std std-ref">Toolchain</span></a> section
describes what to install, and how, on rich a selection of Linux distributions,
FreeBSD and Windows. For example on Debian do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">bullseye</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>With the source available, and toolchain up and running, then go ahead:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>xnvme

<span class="c1"># configure xNVMe and build dependencies (fio, libvfn, and SPDK/NVMe)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir
<span class="nb">cd</span><span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Details on the build-errors can be seen by inspecting
<code class="docutils literal notranslate"><span class="pre">builddir/meson-logs/meson-log.txt</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case you ran the meson-commands before installing, then you
probably need to remove your <code class="docutils literal notranslate"><span class="pre">builddir</span></code> before re-running build commands.</p>
</div>
<p>In case you want to customize the build, e.g. install into a different location
etc. then this is all handled by <a class="reference external" href="https://mesonbuild.com/Builtin-options.html">meson built-in options</a>, in addition to those, then you
can inspect <code class="docutils literal notranslate"><span class="pre">meson_options.txt</span></code> which contains build-options specific to
<strong>xNVMe</strong>. For examples of customizing the build then have a look at the
following <a class="reference internal" href="#sec-building-config"><span class="std std-ref">Custom Configuration</span></a>.</p>
<p>Otherwise, with a successfully built and installed <strong>xNVMe</strong>, then jump to
<a class="reference internal" href="#sec-gs-system-config"><span class="std std-ref">Backends and System Config</span></a> and <a class="reference internal" href="#sec-building-example"><span class="std std-ref">Windows Kernel</span></a>.</p>
</section>
<section id="toolchain">
<span id="sec-building-toolchain"></span><h2>Toolchain<a class="headerlink" href="#toolchain" title="Link to this heading"></a></h2>
<p>The toolchain (compiler, archiver, and linker) used for building <strong>xNVMe</strong>
must support <strong>C11</strong>, <strong>pthreads</strong> and on the system the following tools must
be available:</p>
<ul class="simple">
<li><p>Python (&gt;=3.7)</p></li>
<li><p>meson (&gt;=0.58) and matching version of ninja</p></li>
<li><p>make (gmake)</p></li>
<li><p>gcc/mingw/clang</p></li>
</ul>
<p>Along with libraries:</p>
<ul class="simple">
<li><p>glibc (&gt;= 2.28, for <strong>io_uring/liburing</strong>)</p></li>
<li><p>libaio-dev (&gt;=0.3, For <strong>xNVMe</strong> and <strong>SPDK</strong>)</p></li>
<li><p>libnuma-dev (&gt;=2, For <strong>SPDK</strong>)</p></li>
<li><p>libssl-dev (&gt;=1.1, For <strong>SPDK</strong>)</p></li>
<li><p>liburing (&gt;=2.2, for <strong>xNVMe</strong>)</p></li>
<li><p>uuid-dev (&gt;=2.3, For <strong>SPDK</strong>)</p></li>
</ul>
<p>xNVMe makes use of libraries and interfaces when available and will “gracefully
degrade” when a given library is not available. For example, if liburing is not
available on your system and you do not want to install it, then xNVMe will
simply build without io_uring-support.</p>
<p>The preferred toolchain is <strong>gcc</strong> and the following sections describe how to
install it and required libraries on a set of popular Linux Distributions,
FreeBSD, MacOS, and Windows. If you wish to use a different toolchain then see
the <a class="reference internal" href="#sec-building-custom-toolchain"><span class="std std-ref">Non-GCC Toolchain</span></a>, on how to instrument the build-system
using a compiler other than <strong>gcc</strong>.</p>
<p>In the following sections, the system package-manager is used whenever possible
to install the toolchain and libraries. However, on some Linux distribution
there are not recent enough versions. To circumvent that, then the packages are
installed via the Python package-manager. In some cases even a recent enough
version of Python is not available, to bootstrap it, then Python is built and
installed from source.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When installing packages via the Python package-manager (<code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-m</span>
<span class="pre">pip</span> <span class="pre">install</span></code>), then packages should be installed system-wide. This is
ensure that the installed packages behave as though they were installed
using the system package-manager.</p>
</div>
<p>Package-managers: apk, pkg, dnf, yum, pacman, apt, aptitude, apt-get, pkg,
choco, brew.</p>
<section id="alpine-linux-latest">
<h3>Alpine Linux (latest)<a class="headerlink" href="#alpine-linux-latest" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">alpine</span><span class="o">-</span><span class="n">latest</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install packages via the system package-manager (apk)</span>
apk<span class="w"> </span>add<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bsd-compat-headers<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>build-base<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang15-extra-tools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>coreutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>cunit<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gawk<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>linux-headers<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>musl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>perl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>py3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>util-linux-dev

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-alpine-latest:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe with SPDK and libvfn disabled</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dwith-spdk<span class="o">=</span><span class="nb">false</span>

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are issues with SPDK/DPDK due to incompatibilities with the standard
library provided by <code class="docutils literal notranslate"><span class="pre">musl</span> <span class="pre">libc</span></code>. Additionally, the <code class="docutils literal notranslate"><span class="pre">libexecinfo-dev</span></code>
package is no longer available on Alpine.
Additionally, libvfn also relies on <code class="docutils literal notranslate"><span class="pre">libexecinfo-dev</span></code> which is currently
not available for Alpine Linux. Thus, it is also disabled.
Pull-request fixing these issues are most welcome, until then, disable
libvfn and spdk on Alpine.</p>
</div>
</section>
<section id="arch-linux-latest">
<h3>Arch Linux (latest)<a class="headerlink" href="#arch-linux-latest" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">archlinux</span><span class="o">-</span><span class="n">latest</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install packages via the system package-manager (pacman)</span>
pacman<span class="w"> </span>-Syyu<span class="w"> </span>--noconfirm
pacman<span class="w"> </span>-S<span class="w"> </span>--noconfirm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>base-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>cunit<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libutil-linux<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python-pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python-setuptools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>util-linux-libs

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-archlinux-latest:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The build is configured to install with <code class="docutils literal notranslate"><span class="pre">--prefix=/usr</span></code> this is
intentional such the the <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code> files end up in the default search
path on the system. If you do not want this, then remove <code class="docutils literal notranslate"><span class="pre">--prefix=/usr</span></code>
and adjust your <code class="docutils literal notranslate"><span class="pre">$PKG_CONFIG_PATH</span></code> accordingly.</p>
</div>
</section>
<section id="oracle-linux-9-9">
<h3>Oracle Linux 9 (9)<a class="headerlink" href="#oracle-linux-9-9" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">oraclelinux</span><span class="o">-</span><span class="mf">9.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This repo has CUnit-devel + meson</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="s1">&#39;dnf-command(config-manager)&#39;</span>
dnf<span class="w"> </span>config-manager<span class="w"> </span>--set-enabled<span class="w"> </span>ol9_codeready_builder

<span class="c1"># Install packages via the system package-manager (dnf)</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>CUnit-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-tools-extra<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>diffutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc-c++<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconfig<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>procps<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>unzip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>wget<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>zlib-devel

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx

<span class="c1"># Clone, build and install liburing v2.2</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building liburing are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/axboe/liburing.git<span class="w"> </span>toolbox/third-party/liburing/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/liburing/repository
git<span class="w"> </span>checkout<span class="w"> </span>liburing-2.2
./configure<span class="w"> </span>--libdir<span class="o">=</span>/usr/lib64<span class="w"> </span>--libdevdir<span class="o">=</span>/usr/lib64
make
make<span class="w"> </span>install
<span class="nb">popd</span>

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-oraclelinux-9:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="rocky-linux-9-2-9-2">
<h3>Rocky Linux 9.2 (9.2)<a class="headerlink" href="#rocky-linux-9-2-9-2" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">rockylinux</span><span class="o">-</span><span class="mf">9.2</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This repo has CUnit-devel + meson</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="s1">&#39;dnf-command(config-manager)&#39;</span>
dnf<span class="w"> </span>config-manager<span class="w"> </span>--set-enabled<span class="w"> </span>crb

<span class="c1"># Install packages via the system package-manager (dnf)</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>CUnit-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-tools-extra<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>diffutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc-c++<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconfig<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>procps<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>unzip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>wget<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>zlib-devel

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx

<span class="c1"># Clone, build and install liburing v2.2</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building liburing are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/axboe/liburing.git<span class="w"> </span>toolbox/third-party/liburing/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/liburing/repository
git<span class="w"> </span>checkout<span class="w"> </span>liburing-2.2
./configure<span class="w"> </span>--libdir<span class="o">=</span>/usr/lib64<span class="w"> </span>--libdevdir<span class="o">=</span>/usr/lib64
make
make<span class="w"> </span>install
<span class="nb">popd</span>

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-rockylinux-9.2:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="centos-stream-9-stream9">
<h3>CentOS Stream 9 (stream9)<a class="headerlink" href="#centos-stream-9-stream9" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">centos</span><span class="o">-</span><span class="n">stream9</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This repos has CUnit-devel</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="s1">&#39;dnf-command(config-manager)&#39;</span>
dnf<span class="w"> </span>config-manager<span class="w"> </span>--set-enabled<span class="w"> </span>crb

<span class="c1"># Install packages via the system package-manager (dnf)</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>CUnit-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>diffutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc-c++<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconfig<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>procps<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>unzip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>wget<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>zlib-devel

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip<span class="w"> </span><span class="c1"># Otherwise too old to understand new Manylinux formats</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ninja<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pyelftools

<span class="c1"># Clone, build and install liburing v2.2</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building liburing are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/axboe/liburing.git<span class="w"> </span>toolbox/third-party/liburing/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/liburing/repository
git<span class="w"> </span>checkout<span class="w"> </span>liburing-2.2
./configure<span class="w"> </span>--libdir<span class="o">=</span>/usr/lib64<span class="w"> </span>--libdevdir<span class="o">=</span>/usr/lib64
make
make<span class="w"> </span>install
<span class="nb">popd</span>

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-centos-stream9:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="debian-testing-trixie">
<h3>Debian Testing (trixie)<a class="headerlink" href="#debian-testing-trixie" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">trixie</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unattended update, upgrade, and install</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_PRIORITY</span><span class="o">=</span>critical
apt-get<span class="w"> </span>-qy<span class="w"> </span>update
apt-get<span class="w"> </span>-qy<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confdef&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confold&quot;</span><span class="w"> </span>upgrade
apt-get<span class="w"> </span>-qy<span class="w"> </span>--no-install-recommends<span class="w"> </span>install<span class="w"> </span>apt-utils
apt-get<span class="w"> </span>-qy<span class="w"> </span>autoclean
apt-get<span class="w"> </span>-qy<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>build-essential<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-format<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libcunit1-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libncurses5-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libnuma-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libssl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-venv<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>uuid-dev

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-debian-trixie:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="debian-stable-bookworm">
<h3>Debian Stable (bookworm)<a class="headerlink" href="#debian-stable-bookworm" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">bookworm</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unattended update, upgrade, and install</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_PRIORITY</span><span class="o">=</span>critical
apt-get<span class="w"> </span>-qy<span class="w"> </span>update
apt-get<span class="w"> </span>-qy<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confdef&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confold&quot;</span><span class="w"> </span>upgrade
apt-get<span class="w"> </span>-qy<span class="w"> </span>--no-install-recommends<span class="w"> </span>install<span class="w"> </span>apt-utils
apt-get<span class="w"> </span>-qy<span class="w"> </span>autoclean
apt-get<span class="w"> </span>-qy<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>build-essential<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-format<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libcunit1-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libncurses5-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libnuma-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libssl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-venv<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>uuid-dev

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-debian-bookworm:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="debian-oldstable-bullseye">
<h3>Debian Oldstable (bullseye)<a class="headerlink" href="#debian-oldstable-bullseye" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">bullseye</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unattended update, upgrade, and install</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_PRIORITY</span><span class="o">=</span>critical
apt-get<span class="w"> </span>-qy<span class="w"> </span>update
apt-get<span class="w"> </span>-qy<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confdef&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confold&quot;</span><span class="w"> </span>upgrade
apt-get<span class="w"> </span>-qy<span class="w"> </span>--no-install-recommends<span class="w"> </span>install<span class="w"> </span>apt-utils
apt-get<span class="w"> </span>-qy<span class="w"> </span>autoclean
apt-get<span class="w"> </span>-qy<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>build-essential<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-format<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libcunit1-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libncurses5-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libnuma-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libssl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-venv<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>uuid-dev

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ninja<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx

<span class="c1"># Clone, build and install liburing v2.2</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building liburing are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/axboe/liburing.git<span class="w"> </span>toolbox/third-party/liburing/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/liburing/repository
git<span class="w"> </span>checkout<span class="w"> </span>liburing-2.2
./configure
make
make<span class="w"> </span>install
<span class="nb">popd</span>

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-debian-bullseye:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="fedora-38">
<h3>Fedora (38)<a class="headerlink" href="#fedora-38" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">fedora</span><span class="o">-</span><span class="mf">38.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install packages via the system package-manager (dnf)</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>CUnit-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-tools-extra<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>diffutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>g++<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconfig<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>procps<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>zlib-devel

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-fedora-38:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="fedora-37">
<h3>Fedora (37)<a class="headerlink" href="#fedora-37" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">fedora</span><span class="o">-</span><span class="mf">37.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install packages via the system package-manager (dnf)</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>CUnit-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-tools-extra<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>diffutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>g++<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconfig<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>procps<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>zlib-devel

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-fedora-37:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="fedora-36">
<h3>Fedora (36)<a class="headerlink" href="#fedora-36" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">fedora</span><span class="o">-</span><span class="mf">36.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install packages via the system package-manager (dnf)</span>
dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>CUnit-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-tools-extra<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>diffutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>g++<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>numactl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconfig<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>procps<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>zlib-devel

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>

<span class="c1"># Clone, build and install liburing v2.2</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building liburing are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/axboe/liburing.git<span class="w"> </span>toolbox/third-party/liburing/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/liburing/repository
git<span class="w"> </span>checkout<span class="w"> </span>liburing-2.2
./configure<span class="w"> </span>--libdir<span class="o">=</span>/usr/lib64<span class="w"> </span>--libdevdir<span class="o">=</span>/usr/lib64
make
make<span class="w"> </span>install
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-fedora-36:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
</section>
<section id="ubuntu-latest-lunar">
<h3>Ubuntu Latest (lunar)<a class="headerlink" href="#ubuntu-latest-lunar" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">lunar</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unattended update, upgrade, and install</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_PRIORITY</span><span class="o">=</span>critical
apt-get<span class="w"> </span>-qy<span class="w"> </span>update
apt-get<span class="w"> </span>-qy<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confdef&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confold&quot;</span><span class="w"> </span>upgrade
apt-get<span class="w"> </span>-qy<span class="w"> </span>--no-install-recommends<span class="w"> </span>install<span class="w"> </span>apt-utils
apt-get<span class="w"> </span>-qy<span class="w"> </span>autoclean
apt-get<span class="w"> </span>-qy<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>build-essential<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-format<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libcunit1-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libncurses5-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libnuma-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libssl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-venv<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>uuid-dev

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-ubuntu-lunar:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All tools and libraries are available via system package-manager.</p>
</div>
</section>
<section id="ubuntu-lts-jammy">
<h3>Ubuntu LTS (jammy)<a class="headerlink" href="#ubuntu-lts-jammy" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">jammy</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unattended update, upgrade, and install</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_PRIORITY</span><span class="o">=</span>critical
apt-get<span class="w"> </span>-qy<span class="w"> </span>update
apt-get<span class="w"> </span>-qy<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confdef&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confold&quot;</span><span class="w"> </span>upgrade
apt-get<span class="w"> </span>-qy<span class="w"> </span>--no-install-recommends<span class="w"> </span>install<span class="w"> </span>apt-utils
apt-get<span class="w"> </span>-qy<span class="w"> </span>autoclean
apt-get<span class="w"> </span>-qy<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>build-essential<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-format<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libcunit1-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libncurses5-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libnuma-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libssl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-venv<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>uuid-dev

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ninja

<span class="c1"># Clone, build and install liburing v2.2</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building liburing are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/axboe/liburing.git<span class="w"> </span>toolbox/third-party/liburing/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/liburing/repository
git<span class="w"> </span>checkout<span class="w"> </span>liburing-2.2
./configure
make
make<span class="w"> </span>install
<span class="nb">popd</span>

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-ubuntu-jammy:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Installing liburing from source and meson + ninja via pip</p>
</div>
</section>
<section id="ubuntu-lts-focal">
<h3>Ubuntu LTS (focal)<a class="headerlink" href="#ubuntu-lts-focal" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">focal</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unattended update, upgrade, and install</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
<span class="nb">export</span><span class="w"> </span><span class="nv">DEBIAN_PRIORITY</span><span class="o">=</span>critical
apt-get<span class="w"> </span>-qy<span class="w"> </span>update
apt-get<span class="w"> </span>-qy<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confdef&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="s2">&quot;Dpkg::Options::=--force-confold&quot;</span><span class="w"> </span>upgrade
apt-get<span class="w"> </span>-qy<span class="w"> </span>--no-install-recommends<span class="w"> </span>install<span class="w"> </span>apt-utils
apt-get<span class="w"> </span>-qy<span class="w"> </span>autoclean
apt-get<span class="w"> </span>-qy<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>build-essential<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-format<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libcunit1-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libncurses5-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libnuma-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libssl-dev<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-venv<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>uuid-dev

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ninja

<span class="c1"># Clone, build and install liburing v2.2</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building liburing are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/axboe/liburing.git<span class="w"> </span>toolbox/third-party/liburing/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/liburing/repository
git<span class="w"> </span>checkout<span class="w"> </span>liburing-2.2
./configure
make
make<span class="w"> </span>install
<span class="nb">popd</span>

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-ubuntu-focal:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Installing liburing from source and meson + ninja via pip</p>
</div>
</section>
<section id="gentoo-latest">
<h3>Gentoo (latest)<a class="headerlink" href="#gentoo-latest" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">gentoo</span><span class="o">-</span><span class="n">latest</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;build requires linking against ncurses AND tinfo, run the following before compilation:&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export LDFLAGS=\&quot;-ltinfo -lncurses\&quot;&quot;</span>

emerge-webrsync
emerge<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>app-arch/libarchive<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-lang/nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-libs/libaio<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-libs/openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-python/pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-python/pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-util/cunit<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-util/meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-util/pkgconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>dev-vcs/git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>sys-libs/liburing<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>sys-libs/ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>sys-process/numactl

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--break-system-packages<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--break-system-packages<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-gentoo-latest:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">&quot;-ltinfo -lncurses&quot;</span>

<span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>--prefix<span class="o">=</span>/usr

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case you get <code class="docutils literal notranslate"><span class="pre">error</span> <span class="pre">adding</span> <span class="pre">symbols:</span> <span class="pre">DSO</span> <span class="pre">missing</span> <span class="pre">from</span> <span class="pre">command</span> <span class="pre">line</span></code>,
during compilation, then add <code class="docutils literal notranslate"><span class="pre">-ltinfo</span> <span class="pre">-lnurces</span></code> to <code class="docutils literal notranslate"><span class="pre">LDFLAGS</span></code> as it is
done in the commands above.
The build is configured to install with <code class="docutils literal notranslate"><span class="pre">--prefix=/usr</span></code> this is
intentional such the the <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code> files end up in the default search
path on the system. If you do not want this, then remove <code class="docutils literal notranslate"><span class="pre">--prefix=/usr</span></code>
and adjust your <code class="docutils literal notranslate"><span class="pre">$PKG_CONFIG_PATH</span></code> accordingly.</p>
</div>
</section>
<section id="opensuse-tumbleweed-latest">
<h3>openSUSE (tumbleweed-latest)<a class="headerlink" href="#opensuse-tumbleweed-latest" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">opensuse</span><span class="o">-</span><span class="n">tumbleweed</span><span class="o">-</span><span class="n">latest</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>zypper<span class="w"> </span>--non-interactive<span class="w"> </span>refresh

<span class="c1"># Install packages via the system package-manager (zypper)</span>
zypper<span class="w"> </span>--non-interactive<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrade<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>awk<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>clang-tools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>cunit-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gcc-c++<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gzip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libaio-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libarchive-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libnuma-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libopenssl-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>liburing-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libuuid-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>make<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkg-config<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-devel<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>tar

<span class="c1">#</span>
<span class="c1"># Clone, build and install libvfn</span>
<span class="c1">#</span>
<span class="c1"># Assumptions:</span>
<span class="c1">#</span>
<span class="c1"># - Dependencies for building libvfn are met (system packages etc.)</span>
<span class="c1"># - Commands are executed with sufficient privileges (sudo/root)</span>
<span class="c1">#</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OpenMPDK/libvfn.git<span class="w"> </span>toolbox/third-party/libvfn/repository

<span class="nb">pushd</span><span class="w"> </span>toolbox/third-party/libvfn/repository
git<span class="w"> </span>checkout<span class="w"> </span>v3.0.0-rc2
meson<span class="w"> </span>setup<span class="w"> </span>builddir<span class="w"> </span>-Dlibnvme<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>-Ddocs<span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="w"> </span>--buildtype<span class="o">=</span>release<span class="w"> </span>--prefix<span class="o">=</span>/usr
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir
<span class="nb">popd</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-opensuse-tumbleweed-latest:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All tools and libraries are available via system package-manager.</p>
</div>
</section>
<section id="freebsd-13">
<h3>FreeBSD (13)<a class="headerlink" href="#freebsd-13" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">freebsd</span><span class="o">-</span><span class="mf">13.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install packages via the system package-manager (pkg)</span>
pkg<span class="w"> </span>install<span class="w"> </span>-qy<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>autoconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>automake<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>bash<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>cunit<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>devel/py-pyelftools<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>e2fsprogs-libuuid<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>findutils<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>git<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>gmake<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>libtool<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>meson<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>nasm<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>ncurses<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>openssl<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>patch<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pkgconf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>py39-pipx<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>wget

<span class="c1"># Upgrade pip</span>
python3<span class="w"> </span>-m<span class="w"> </span>ensurepip<span class="w"> </span>--upgrade

<span class="c1"># Installing meson via pip as the one available &#39;pkg install&#39; currently that is 0.62.2, breaks with</span>
<span class="c1"># a &quot;File name too long&quot;, 0.60 seems ok.</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="nv">meson</span><span class="o">==</span><span class="m">0</span>.60
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-freebsd-13:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfaces; libaio, liburing, and libvfn are not supported on FreeBSD.</p>
</div>
</section>
<section id="macos-13">
<h3>macOS (13)<a class="headerlink" href="#macos-13" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">macos</span><span class="o">-</span><span class="mf">13.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is done to avoid appleframework deprecation warnings</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MACOSX_DEPLOYMENT_TARGET</span><span class="o">=</span><span class="m">11</span>.0
<span class="nb">export</span><span class="w"> </span><span class="nv">HOMEBREW_NO_AUTO_UPDATE</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Install packages via brew, assuming that brew is: installed, updated, and upgraded</span>
clang-format<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>clang-format<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
git<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
<span class="k">if</span><span class="w"> </span>make<span class="w"> </span>--version<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>i386-apple<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>brew<span class="w"> </span>install<span class="w"> </span>make
<span class="k">fi</span>

meson<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>meson<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
pkg-config<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>pkg-config<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
python3<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>python3<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-macos-13:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure xNVMe and build meson subprojects(SPDK)</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfaces; libaio, liburing, libvfn, and SPDK are not supported on macOS.</p>
</div>
</section>
<section id="macos-12">
<h3>macOS (12)<a class="headerlink" href="#macos-12" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">macos</span><span class="o">-</span><span class="mf">12.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is done to avoid appleframework deprecation warnings</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MACOSX_DEPLOYMENT_TARGET</span><span class="o">=</span><span class="m">11</span>.0
<span class="nb">export</span><span class="w"> </span><span class="nv">HOMEBREW_NO_AUTO_UPDATE</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Install packages via brew, assuming that brew is: installed, updated, and upgraded</span>
clang-format<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>clang-format<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
git<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
<span class="k">if</span><span class="w"> </span>make<span class="w"> </span>--version<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>i386-apple<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>brew<span class="w"> </span>install<span class="w"> </span>make
<span class="k">fi</span>

meson<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>meson<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
pkg-config<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>pkg-config<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
python3<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>python3<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-macos-12:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is done to avoid appleframework deprecation warnings</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MACOSX_DEPLOYMENT_TARGET</span><span class="o">=</span><span class="m">11</span>.0

<span class="c1"># configure xNVMe</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
sudo<span class="w"> </span>meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfaces; libaio, liburing, libvfn, and SPDK are not supported on macOS.</p>
</div>
</section>
<section id="macos-11">
<h3>macOS (11)<a class="headerlink" href="#macos-11" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as <code class="docutils literal notranslate"><span class="pre">root</span></code> or with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>), by executing the commands below. You can
run this from the root of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">xnvme</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">macos</span><span class="o">-</span><span class="mf">11.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is done to avoid appleframework deprecation warnings</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MACOSX_DEPLOYMENT_TARGET</span><span class="o">=</span><span class="m">11</span>.0
<span class="nb">export</span><span class="w"> </span><span class="nv">HOMEBREW_NO_AUTO_UPDATE</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Install packages via brew, assuming that brew is: installed, updated, and upgraded</span>
clang-format<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>clang-format<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
git<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
<span class="k">if</span><span class="w"> </span>make<span class="w"> </span>--version<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>i386-apple<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>brew<span class="w"> </span>install<span class="w"> </span>make
<span class="k">fi</span>

meson<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>meson<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
pkg-config<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>pkg-config<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>
python3<span class="w"> </span>--version<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installed&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>python3<span class="w"> </span>--overwrite<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed installing&quot;</span>

<span class="c1"># Install packages via the Python package-manager (pip)</span>
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>pipx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Docker-image is provided via <code class="docutils literal notranslate"><span class="pre">ghcr.io</span></code>, specifically
<code class="docutils literal notranslate"><span class="pre">ghcr.io/xnvme/xnvme-deps-macos-11:next</span></code>. This Docker-image contains
all the software described above.</p>
</div>
<p>Then go ahead and configure, build and install using <code class="docutils literal notranslate"><span class="pre">meson</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is done to avoid appleframework deprecation warnings</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MACOSX_DEPLOYMENT_TARGET</span><span class="o">=</span><span class="m">11</span>.0

<span class="c1"># configure xNVMe</span>
meson<span class="w"> </span>setup<span class="w"> </span>builddir

<span class="c1"># build xNVMe</span>
meson<span class="w"> </span>compile<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># install xNVMe</span>
sudo<span class="w"> </span>meson<span class="w"> </span>install<span class="w"> </span>-C<span class="w"> </span>builddir

<span class="c1"># uninstall xNVMe</span>
<span class="c1"># cd builddir &amp;&amp; meson --internal uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfaces; libaio, liburing, libvfn, and SPDK are not supported on macOS.</p>
</div>
</section>
<section id="windows-2022">
<h3>Windows (2022)<a class="headerlink" href="#windows-2022" title="Link to this heading"></a></h3>
<p>Install the required toolchain and libraries, with sufficient system privileges
(e.g. as eleveted command prompt), by executing the commands below. You can
run this on administrator command prompt of the <strong>xNVMe</strong> by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">call</span> <span class="n">xnvme</span>\<span class="n">toolbox</span>\<span class="n">pkgs</span>\<span class="n">windows</span><span class="o">-</span><span class="mf">2022.</span><span class="n">bat</span>
</pre></div>
</div>
<p>Or, run the commands contained within the script manually:</p>
<div class="highlight-batch notranslate"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">echo</span> off
<span class="p">@</span><span class="k">setlocal</span> enableextensions enabledelayedexpansion

net session <span class="p">&gt;</span>nul: <span class="mi">2</span><span class="p">&gt;&amp;</span><span class="mi">1</span>
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> <span class="nv">%0</span> must be run with Administrator privileges
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>

<span class="p">:</span><span class="c1">: Use PowerShell to install Chocolatey</span>
<span class="k">set</span> <span class="s2">&quot;PATH=</span><span class="nv">%ALLUSERSPROFILE%</span><span class="s2">\chocolatey\bin;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
<span class="k">echo</span> [1/6] Install: Chocolatey Manager
powershell -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command <span class="s2">&quot;[System.Net.ServicePointManager]::SecurityProtocol = 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;))&quot;</span>
where /q choco
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> [1/6] Install: Chocolatey = FAIL
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>
<span class="k">echo</span> [1/6] Install: Chocolatey = PASS

<span class="p">:</span><span class="c1">: Use Chocolatey to install msys2</span>
<span class="k">echo</span> [2/6] Install: MSYS2
<span class="k">set</span> <span class="s2">&quot;PATH=</span><span class="nv">%SystemDrive%</span><span class="s2">\msys64;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
choco install msys2 -y -r --params <span class="s2">&quot;/NoUpdate /InstallDir:C:\msys64&quot;</span>
where /q msys2
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> [2/6] Install: MSYS2 = FAIL
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>
<span class="k">echo</span> [2/6] Install: MSYS2 = PASS

<span class="k">echo</span> [3/6] Install: Git
choco install git -y -r
<span class="k">echo</span> [3/6] Install: Git = PASS

<span class="k">echo</span> [4/6] Install: dos2unix
choco install dos2unix
<span class="k">echo</span> [4/6] Install: dos2unix = PASS

<span class="p">:</span><span class="c1">: Use MSYS2/pacman to install gcc and clang toolchain</span>
<span class="k">set</span> <span class="nv">MSYS2</span><span class="p">=</span>call msys2_shell -no-start -here -use-full-path -defterm

<span class="k">echo</span> [5/6] Install: MinGW Toolchain via msys2/pacman
<span class="k">set</span> <span class="s2">&quot;PATH=</span><span class="nv">%SystemDrive%</span><span class="s2">\msys64\mingw64\bin;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
<span class="nv">%MSYS2%</span> -c <span class="s2">&quot;pacman --noconfirm -Syy --needed base-devel mingw-w64-x86_64-toolchain&quot;</span>
where /q gcc
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> [5/6] Install: MinGW Toolchain via msys2/pacman = FAIL
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>
<span class="k">echo</span> [5/6] Install: MinGW Toolchain via msys2/pacman = PASS

<span class="k">echo</span> [6/6] Install: MinGW/meson via msys2/pacman
<span class="nv">%MSYS2%</span> -c <span class="s2">&quot;pacman --noconfirm -Syy mingw-w64-x86_64-meson&quot;</span>
<span class="k">echo</span> [6/6] Install: MinGW/meson via msys2/pacman = OK
</pre></div>
</div>
<p>Then go ahead and configure, build and install using helper batch script <code class="docutils literal notranslate"><span class="pre">build.bat</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1"># build: auto-configure xNVMe, build third-party libraries, and xNVMe itself</span>
<span class="w">  </span>build.bat

<span class="w">  </span><span class="c1"># config: only configure xNVMe</span>
<span class="w">  </span>build.bat<span class="w"> </span>config

<span class="w">  </span><span class="c1"># config: debug only configure xNVMe</span>
<span class="w">  </span>build.bat<span class="w"> </span>config-debug

<span class="w">  </span><span class="c1"># install xNVMe</span>
<span class="w">  </span>build.bat<span class="w"> </span>install

<span class="w">  </span><span class="c1"># uninstall xNVMe</span>
<span class="w">  </span><span class="c1"># build.bat uninstall</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case you see <code class="docutils literal notranslate"><span class="pre">.dll</span></code> loader-errors, then check that the environment
variable <code class="docutils literal notranslate"><span class="pre">PATH</span></code> contains the various library locations of the toolchain.
Interfaces; libaio, liburing, libvfn, and SPDK are not supported on
Windows.</p>
</div>
</section>
</section>
<section id="backends-and-system-config">
<span id="sec-gs-system-config"></span><h2>Backends and System Config<a class="headerlink" href="#backends-and-system-config" title="Link to this heading"></a></h2>
<p><strong>xNVMe</strong> relies on certain Operating System Kernel features and infrastructure
that must be available and correctly configured. This subsection goes through
what is used on Linux and how check whether is it available.</p>
<section id="backends">
<h3>Backends<a class="headerlink" href="#backends" title="Link to this heading"></a></h3>
<p>The purpose of <strong>xNVMe</strong> backends are to provide an instrumental runtime
supporting the <strong>xNVMe</strong> API in a single library with <strong>batteries included</strong>.</p>
<p>That is, it comes with the essential third-party libraries bundled into the
<strong>xNVMe</strong> library. Thus, you get a single C API to program against and a single
library to link with. And similarly for the command-line tools; a single binary
to communicating with devices via the I/O stacks that available on the system.</p>
<p>To inspect the libraries which <strong>xNVMe</strong> is build against and the
supported/enabled backends then invoke:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme<span class="w"> </span>library-info
</pre></div>
</div>
<p>It should produce output similar to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># xNVMe Library Information</span>
ver:<span class="w"> </span><span class="o">{</span>major:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>minor:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>patch:<span class="w"> </span><span class="m">3</span><span class="o">}</span>
xnvme_libconf:
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;3p: spdk;git-describe:v22.09;+patches&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_CBI_ADMIN_SHIM_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_CBI_ASYNC_EMU_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_CBI_ASYNC_NIL_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_CBI_ASYNC_POSIX_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_CBI_ASYNC_THRPOOL_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_CBI_MEM_POSIX_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_CBI_SYNC_PSYNC_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_RAMDISK_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_LINUX_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_LINUX_BLOCK_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_LINUX_BLOCK_ZONED_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_LINUX_LIBAIO_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_LINUX_LIBURING_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_LINUX_VFIO_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_SPDK_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_SPDK_TRANSPORT_PCIE_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_SPDK_TRANSPORT_TCP_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_SPDK_TRANSPORT_RDMA_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_SPDK_TRANSPORT_FC_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;conf: XNVME_BE_ASYNC_ENABLED&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;3p: linux;LINUX_VERSION_CODE-UAPI/393728-6.2.0&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;3p: NVME_IOCTL_IO64_CMD&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;3p: NVME_IOCTL_IO64_CMD_VEC&#39;</span>
<span class="w">  </span>-<span class="w"> </span><span class="s1">&#39;3p: NVME_IOCTL_ADMIN64_CMD&#39;</span>
xnvme_be_attr_list:
<span class="w">  </span>count:<span class="w"> </span><span class="m">7</span>
<span class="w">  </span>capacity:<span class="w"> </span><span class="m">7</span>
<span class="w">  </span>items:
<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;spdk&#39;</span>
<span class="w">    </span>enabled:<span class="w"> </span><span class="m">1</span>

<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;linux&#39;</span>
<span class="w">    </span>enabled:<span class="w"> </span><span class="m">1</span>

<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;fbsd&#39;</span>
<span class="w">    </span>enabled:<span class="w"> </span><span class="m">0</span>

<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;macos&#39;</span>
<span class="w">    </span>enabled:<span class="w"> </span><span class="m">0</span>

<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;windows&#39;</span>
<span class="w">    </span>enabled:<span class="w"> </span><span class="m">0</span>

<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;ramdisk&#39;</span>
<span class="w">    </span>enabled:<span class="w"> </span><span class="m">1</span>

<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;vfio&#39;</span>
<span class="w">    </span>enabled:<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">xnvme_3p</span></code> part of the output informs about the third-party projects
which <strong>xNVMe</strong> was built against, and in the case of libraries, the version it
has bundled.</p>
<p>Although a single API and a single library is provided by <strong>xNVMe</strong>, then
runtime and system configuration dependencies remain. The following subsections
describe how to instrument <strong>xNVMe</strong> to utilize the different kernel interfaces
and user space drivers.</p>
</section>
<section id="kernel">
<h3>Kernel<a class="headerlink" href="#kernel" title="Link to this heading"></a></h3>
<p>Linux Kernel version 5.9 or newer is currently preferred as it has all the
features which <strong>xNVMe</strong> utilizes. This section also gives you a brief overview
of the different I/O paths and APIs which the <strong>xNVMe</strong> API unifies access to.</p>
<section id="nvme-driver-and-ioctls">
<h4>NVMe Driver and IOCTLs<a class="headerlink" href="#nvme-driver-and-ioctls" title="Link to this heading"></a></h4>
<p>The default for <strong>xNVMe</strong> is to communicate with devices via the operating
system NVMe driver IOCTLs, specifically on Linux the following are used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NVME_IOCTL_ID</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NVME_IOCTL_IO_CMD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NVME_IOCTL_ADMIN_CMD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NVME_IOCTL_IO64_CMD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NVME_IOCTL_ADMIN64_CMD</span></code></p></li>
</ul>
<p>In case the <code class="docutils literal notranslate"><span class="pre">*64_CMD</span></code> IOCTLs are not available then <strong>xNVMe</strong> falls back to
using the non-64bit equivalents. The 64 vs 32 completion result mostly affect
commands such as Zone Append. You can check that this interface is behaving as
expected by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme<span class="w"> </span>info<span class="w"> </span>/dev/nvme0n1
</pre></div>
</div>
<p>Which you yield output equivalent to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_dev:
<span class="w">  </span>xnvme_ident:
<span class="w">    </span>uri:<span class="w"> </span><span class="s1">&#39;/dev/nvme0n1&#39;</span>
<span class="w">    </span>dtype:<span class="w"> </span>0x2
<span class="w">    </span>nsid:<span class="w"> </span>0x1
<span class="w">    </span>csi:<span class="w"> </span>0x0
<span class="w">    </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:deadbeef&#39;</span>
<span class="w">  </span>xnvme_be:
<span class="w">    </span>admin:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
</pre></div>
</div>
<p>This tells you that <strong>xNVMe</strong> can communicate with the given device identifier
and it informs you that it utilizes <strong>nvme_ioctl</strong> for synchronous command
execution and it uses <strong>thr</strong> for asynchronous command execution.  Since IOCTLs
are inherently synchronous then <strong>xNVMe</strong> mimics asynchronous behavior over
IOCTLs to support the asynchronous primitives provided by the <strong>xNVMe</strong> API.</p>
</section>
<section id="block-layer">
<h4>Block Layer<a class="headerlink" href="#block-layer" title="Link to this heading"></a></h4>
<p>In case your device is <strong>not</strong> an NVMe device, then the NVMe IOCTLs won’t be
available. <strong>xNVMe</strong> will then try to utilize the Linux Block Layer and treat
a given block device as a NVMe device via shim-layer for NVMe admin commands
such as identify and get-features.</p>
<p>A brief example of checking this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a NULL Block instance</span>
modprobe<span class="w"> </span>null_blk<span class="w"> </span><span class="nv">nr_devices</span><span class="o">=</span><span class="m">1</span>
<span class="c1"># Open and query the NULL Block instance with xNVMe</span>
xnvme<span class="w"> </span>info<span class="w"> </span>/dev/nullb0
<span class="c1"># Remove the NULL Block instance</span>
modprobe<span class="w"> </span>-r<span class="w"> </span>null_blk
</pre></div>
</div>
<p>Yielding:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_dev:
<span class="w">  </span>xnvme_ident:
<span class="w">    </span>uri:<span class="w"> </span><span class="s1">&#39;/dev/nullb0&#39;</span>
<span class="w">    </span>dtype:<span class="w"> </span>0x3
<span class="w">    </span>nsid:<span class="w"> </span>0x1
<span class="w">    </span>csi:<span class="w"> </span>0x1f
<span class="w">    </span>subnqn:<span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">  </span>xnvme_be:
<span class="w">    </span>admin:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;block&#39;</span><span class="o">}</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;block&#39;</span><span class="o">}</span>
<span class="w">    </span>async:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;emu&#39;</span><span class="o">}</span>
<span class="w">    </span>attr:<span class="w"> </span><span class="o">{</span>name:<span class="w"> </span><span class="s1">&#39;linux&#39;</span><span class="o">}</span>
<span class="w">  </span>xnvme_opts:
<span class="w">    </span>be:<span class="w"> </span><span class="s1">&#39;linux&#39;</span>
<span class="w">    </span>mem:<span class="w"> </span><span class="s1">&#39;posix&#39;</span>
<span class="w">    </span>dev:<span class="w"> </span><span class="s1">&#39;FIX-ID-VS-MIXIN-NAME&#39;</span>
<span class="w">    </span>admin:<span class="w"> </span><span class="s1">&#39;block&#39;</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="s1">&#39;block&#39;</span>
<span class="w">    </span>async:<span class="w"> </span><span class="s1">&#39;emu&#39;</span>
<span class="w">  </span>xnvme_geo:
<span class="w">    </span>type:<span class="w"> </span>XNVME_GEO_CONVENTIONAL
<span class="w">    </span>npugrp:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>npunit:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>nzone:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>nsect:<span class="w"> </span><span class="m">524288000</span>
<span class="w">    </span>nbytes:<span class="w"> </span><span class="m">512</span>
<span class="w">    </span>nbytes_oob:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>tbytes:<span class="w"> </span><span class="m">268435456000</span>
<span class="w">    </span>mdts_nbytes:<span class="w"> </span><span class="m">65024</span>
<span class="w">    </span>lba_nbytes:<span class="w"> </span><span class="m">512</span>
<span class="w">    </span>lba_extended:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>ssw:<span class="w"> </span><span class="m">9</span>
</pre></div>
</div>
</section>
<section id="block-zoned-ioctls">
<h4>Block Zoned IOCTLs<a class="headerlink" href="#block-zoned-ioctls" title="Link to this heading"></a></h4>
<p>Building on the Linux Block model, then the Zoned Block Device model is also
utilized, specifically the following IOCTLs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BLK_ZONE_REP_CAPACITY</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLKCLOSEZONE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLKFINISHZONE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLKOPENZONE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLKRESETZONE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLKGETNRZONES</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLKREPORTZONE</span></code></p></li>
</ul>
<p>When available, then <strong>xNVMe</strong> can make use of the above IOCTLs. This is
mostly useful when developing/testing using Linux Null Block devices.
And similar for a Zoned NULL Block instance:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a Zoned NULL Block instance</span>
modprobe<span class="w"> </span>null_blk<span class="w"> </span><span class="nv">nr_devices</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">zoned</span><span class="o">=</span><span class="m">1</span>
<span class="c1"># Open and query the Zoned NULL Block instance with xNVMe</span>
xnvme<span class="w"> </span>info<span class="w"> </span>/dev/nullb0
<span class="c1"># Remove the Zoned NULL Block instance</span>
modprobe<span class="w"> </span>-r<span class="w"> </span>null_blk
</pre></div>
</div>
<p>Yielding:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_dev:
<span class="w">  </span>xnvme_ident:
<span class="w">    </span>uri:<span class="w"> </span><span class="s1">&#39;/dev/nullb0&#39;</span>
<span class="w">    </span>dtype:<span class="w"> </span>0x3
<span class="w">    </span>nsid:<span class="w"> </span>0x1
<span class="w">    </span>csi:<span class="w"> </span>0x2
<span class="w">    </span>subnqn:<span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">  </span>xnvme_be:
<span class="w">    </span>admin:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;block&#39;</span><span class="o">}</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;block&#39;</span><span class="o">}</span>
<span class="w">    </span>async:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;emu&#39;</span><span class="o">}</span>
<span class="w">    </span>attr:<span class="w"> </span><span class="o">{</span>name:<span class="w"> </span><span class="s1">&#39;linux&#39;</span><span class="o">}</span>
<span class="w">  </span>xnvme_opts:
<span class="w">    </span>be:<span class="w"> </span><span class="s1">&#39;linux&#39;</span>
<span class="w">    </span>mem:<span class="w"> </span><span class="s1">&#39;posix&#39;</span>
<span class="w">    </span>dev:<span class="w"> </span><span class="s1">&#39;FIX-ID-VS-MIXIN-NAME&#39;</span>
<span class="w">    </span>admin:<span class="w"> </span><span class="s1">&#39;block&#39;</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="s1">&#39;block&#39;</span>
<span class="w">    </span>async:<span class="w"> </span><span class="s1">&#39;emu&#39;</span>
<span class="w">  </span>xnvme_geo:
<span class="w">    </span>type:<span class="w"> </span>XNVME_GEO_ZONED
<span class="w">    </span>npugrp:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>npunit:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>nzone:<span class="w"> </span><span class="m">1000</span>
<span class="w">    </span>nsect:<span class="w"> </span><span class="m">524288</span>
<span class="w">    </span>nbytes:<span class="w"> </span><span class="m">512</span>
<span class="w">    </span>nbytes_oob:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>tbytes:<span class="w"> </span><span class="m">268435456000</span>
<span class="w">    </span>mdts_nbytes:<span class="w"> </span><span class="m">65024</span>
<span class="w">    </span>lba_nbytes:<span class="w"> </span><span class="m">512</span>
<span class="w">    </span>lba_extended:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>ssw:<span class="w"> </span><span class="m">9</span>
</pre></div>
</div>
</section>
<section id="async-i-o-via-libaio">
<h4>Async I/O via <code class="docutils literal notranslate"><span class="pre">libaio</span></code><a class="headerlink" href="#async-i-o-via-libaio" title="Link to this heading"></a></h4>
<p>When AIO is available then the NVMe NVM Commands for <strong>read</strong> and <strong>write</strong> are
sent over the Linux AIO interface. Doing so improves command-throughput at
higher queue-depths when compared to sending the command over via the NVMe
driver ioctl().</p>
<p>One can explicitly tell <strong>xNVMe</strong> to utilize <code class="docutils literal notranslate"><span class="pre">libaio</span></code> for async I/O by
encoding it in the device identifier, like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_io_async<span class="w"> </span><span class="nb">read</span><span class="w"> </span>/dev/nvme0n1<span class="w"> </span>--slba<span class="w"> </span>0x0<span class="w"> </span>--qdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--async<span class="w"> </span>libaio
</pre></div>
</div>
<p>Yielding the output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Allocating and filling buf of nbytes: 4096</span>
<span class="c1"># Initializing queue and setting default callback function and arguments</span>
<span class="c1"># Read uri: &#39;/dev/nvme0n1&#39;, qd: 1</span>
xnvme_lba_range:
<span class="w">  </span>slba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>elba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>naddrs:<span class="w"> </span><span class="m">1</span>
<span class="w">  </span>nbytes:<span class="w"> </span><span class="m">4096</span>
<span class="w">  </span>attr:<span class="w"> </span><span class="o">{</span><span class="w"> </span>is_zones:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>is_valid:<span class="w"> </span><span class="m">1</span><span class="o">}</span>
wall-clock:<span class="w"> </span><span class="o">{</span>elapsed:<span class="w"> </span><span class="m">0</span>.0002,<span class="w"> </span>mib:<span class="w"> </span><span class="m">0</span>.00,<span class="w"> </span>mib_sec:<span class="w"> </span><span class="m">21</span>.87<span class="o">}</span>
<span class="c1"># cb_args: {submitted: 1, completed: 1, ecount: 0}</span>
</pre></div>
</div>
</section>
<section id="async-i-o-via-io-uring">
<h4>Async. I/O via <code class="docutils literal notranslate"><span class="pre">io_uring</span></code><a class="headerlink" href="#async-i-o-via-io-uring" title="Link to this heading"></a></h4>
<p><strong>xNVMe</strong> utilizes the Linux <strong>io_uring</strong> interface, its support for
feature-probing the <strong>io_uring</strong> interface and the <strong>io_uring</strong> opcodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IORING_OP_READ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IORING_OP_WRITE</span></code></p></li>
</ul>
<p>When available, then <strong>xNVMe</strong> can send the NVMe NVM Commands for <strong>read</strong> and
<strong>write</strong> via the Linux <strong>io_uring</strong> interface. Doing so improves
command-throughput at all io-depths when compared to sending the command via
NVMe Driver IOCTLs and libaio. It also leverages the <strong>io_uring</strong> interface to
enabling I/O polling and kernel-side submission polling.</p>
<p>One can explicitly tell <strong>xNVMe</strong> to utilize <code class="docutils literal notranslate"><span class="pre">io_uring</span></code> for async I/O by
encoding it in the device identifier, like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_io_async<span class="w"> </span><span class="nb">read</span><span class="w"> </span>/dev/nvme0n1<span class="w"> </span>--slba<span class="w"> </span>0x0<span class="w"> </span>--qdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--async<span class="w"> </span>io_uring
</pre></div>
</div>
<p>Yielding the output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Allocating and filling buf of nbytes: 4096</span>
<span class="c1"># Initializing queue and setting default callback function and arguments</span>
<span class="c1"># Read uri: &#39;/dev/nvme0n1&#39;, qd: 1</span>
xnvme_lba_range:
<span class="w">  </span>slba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>elba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>naddrs:<span class="w"> </span><span class="m">1</span>
<span class="w">  </span>nbytes:<span class="w"> </span><span class="m">4096</span>
<span class="w">  </span>attr:<span class="w"> </span><span class="o">{</span><span class="w"> </span>is_zones:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>is_valid:<span class="w"> </span><span class="m">1</span><span class="o">}</span>
wall-clock:<span class="w"> </span><span class="o">{</span>elapsed:<span class="w"> </span><span class="m">0</span>.0003,<span class="w"> </span>mib:<span class="w"> </span><span class="m">0</span>.00,<span class="w"> </span>mib_sec:<span class="w"> </span><span class="m">15</span>.15<span class="o">}</span>
<span class="c1"># cb_args: {submitted: 1, completed: 1, ecount: 0}</span>
</pre></div>
</div>
</section>
</section>
<section id="user-space">
<span id="sec-gs-system-config-userspace"></span><h3>User Space<a class="headerlink" href="#user-space" title="Link to this heading"></a></h3>
<p>Linux provides the <strong>Userspace I/O</strong> (<a class="reference external" href="https://www.kernel.org/doc/html/v4.14/driver-api/uio-howto.html">uio</a>) and <strong>Virtual Function I/O</strong>
<a class="reference external" href="https://www.kernel.org/doc/Documentation/vfio.txt">vfio</a> frameworks to write user space I/O drivers. Both interfaces work by
binding a given device to an in-kernel stub-driver. The stub-driver in turn
exposes device-memory and device-interrupts to user space. Thus enabling the
implementation of device drivers entirely in user space.</p>
<p>Although Linux provides a capable NVMe Driver with flexible IOCTLs, then a user
space NVMe driver serves those who seek the lowest possible per-command
processing overhead or wants full control over NVMe command construction,
including command-payloads.</p>
<p>Fortunately, you do not need to go and write an user space NVMe driver since a
highly efficient, mature and well-maintained driver already exists. Namely, the
NVMe driver provided by the <strong>Storage Platform Development Kit</strong> (<span class="target" id="spdk">SPDK</span>).</p>
<p>Another great fortune is that <strong>xNVMe</strong> bundles the SPDK NVMe Driver with the
<strong>xNVMe</strong> library. So, if you have built and installed <strong>xNVMe</strong> then the
<strong>SPDK</strong> NVMe Driver is readily available to <strong>xNVMe</strong>.</p>
<p>The following subsections goes through a configuration checklist, then shows
how to bind and unbind drivers, and lastly how to utilize non-devfs device
identifiers by enumerating the system and inspecting a device.</p>
<section id="config">
<span id="sec-gs-system-config-userspace-config"></span><h4>Config<a class="headerlink" href="#config" title="Link to this heading"></a></h4>
<p>What remains is checking your system configuration, enabling IOMMU for use by
the <code class="docutils literal notranslate"><span class="pre">vfio-pci</span></code> driver, and possibly falling back to the <code class="docutils literal notranslate"><span class="pre">uio_pci_generic</span></code>
driver in case <code class="docutils literal notranslate"><span class="pre">vfio-pci</span></code> is not working out.  <code class="docutils literal notranslate"><span class="pre">vfio</span></code> is preferred as
hardware support for IOMMU allows for isolation between devices.</p>
<ol class="arabic simple">
<li><p>Verify that your CPU supports virtualization / VT-d and that it is enabled
in your board BIOS.</p></li>
<li><p>Enable your kernel for an intel CPU then provide the kernel option
<code class="docutils literal notranslate"><span class="pre">intel_iommu=on</span></code>.  If you have a non-Intel CPU then consult documentation
on enabling VT-d / IOMMU for your CPU.</p></li>
<li><p>Increase limits, open <code class="docutils literal notranslate"><span class="pre">/etc/security/limits.conf</span></code> and add:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span>    <span class="n">soft</span> <span class="n">memlock</span> <span class="n">unlimited</span>
<span class="o">*</span>    <span class="n">hard</span> <span class="n">memlock</span> <span class="n">unlimited</span>
<span class="n">root</span> <span class="n">soft</span> <span class="n">memlock</span> <span class="n">unlimited</span>
<span class="n">root</span> <span class="n">hard</span> <span class="n">memlock</span> <span class="n">unlimited</span>
</pre></div>
</div>
<p>Once you have gone through these steps, and rebooted, then this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;DMAR: IOMMU&quot;</span>
</pre></div>
</div>
<p>Should output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="w">    </span><span class="m">0</span>.116570<span class="o">]</span><span class="w"> </span>DMAR:<span class="w"> </span>IOMMU<span class="w"> </span>enabled
</pre></div>
</div>
<p>And this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>find<span class="w"> </span>/sys/kernel/iommu_groups/<span class="w"> </span>-type<span class="w"> </span>l
</pre></div>
</div>
<p>Should have output similar to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/sys/kernel/iommu_groups/7/devices/0000:03:00.0
/sys/kernel/iommu_groups/7/devices/0000:02:00.0
/sys/kernel/iommu_groups/5/devices/0000:00:1f.2
/sys/kernel/iommu_groups/5/devices/0000:00:1f.0
/sys/kernel/iommu_groups/5/devices/0000:00:1f.3
/sys/kernel/iommu_groups/3/devices/0000:00:03.0
/sys/kernel/iommu_groups/1/devices/0000:00:01.0
/sys/kernel/iommu_groups/8/devices/0000:04:00.0
/sys/kernel/iommu_groups/8/devices/0000:02:01.0
/sys/kernel/iommu_groups/6/devices/0000:01:00.0
/sys/kernel/iommu_groups/4/devices/0000:00:04.0
/sys/kernel/iommu_groups/2/devices/0000:00:02.0
/sys/kernel/iommu_groups/10/devices/0000:02:03.0
/sys/kernel/iommu_groups/10/devices/0000:06:00.0
/sys/kernel/iommu_groups/0/devices/0000:00:00.0
/sys/kernel/iommu_groups/9/devices/0000:02:02.0
/sys/kernel/iommu_groups/9/devices/0000:05:00.0
</pre></div>
</div>
</section>
<section id="unbinding-and-binding">
<h4>Unbinding and binding<a class="headerlink" href="#unbinding-and-binding" title="Link to this heading"></a></h4>
<p>With the system configured then you can use the <code class="docutils literal notranslate"><span class="pre">xnvme-driver</span></code> script to bind
and unbind devices. The <code class="docutils literal notranslate"><span class="pre">xnvme-driver</span></code> script is a merge of the <strong>SPDK</strong>
<code class="docutils literal notranslate"><span class="pre">setup.sh</span></code> script and its dependencies.</p>
<p>By running the command below <strong>8GB</strong> of hugepages will be configured, the
Kernel NVMe driver unbound, and <code class="docutils literal notranslate"><span class="pre">vfio-pci</span></code> bound to the device:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">HUGEMEM</span><span class="o">=</span><span class="m">4096</span><span class="w"> </span>xnvme-driver
</pre></div>
</div>
<p>The command above should produce output similar to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">0000</span>:03:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>nvme<span class="w"> </span>-&gt;<span class="w"> </span>vfio-pci
<span class="m">0000</span>:04:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>nvme<span class="w"> </span>-&gt;<span class="w"> </span>vfio-pci
<span class="m">0000</span>:05:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>nvme<span class="w"> </span>-&gt;<span class="w"> </span>vfio-pci
<span class="m">0000</span>:06:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>nvme<span class="w"> </span>-&gt;<span class="w"> </span>vfio-pci
<span class="m">0000</span>:00:02.0<span class="w"> </span><span class="o">(</span>1af4<span class="w"> </span><span class="m">1001</span><span class="o">)</span>:<span class="w"> </span>Active<span class="w"> </span>mountpoints<span class="w"> </span>on<span class="w"> </span>/dev/vda,<span class="w"> </span>so<span class="w"> </span>not<span class="w"> </span>binding

Current<span class="w"> </span>user<span class="w"> </span>memlock<span class="w"> </span>limit:<span class="w"> </span><span class="m">743</span><span class="w"> </span>MB

This<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>maximum<span class="w"> </span>amount<span class="w"> </span>of<span class="w"> </span>memory<span class="w"> </span>you<span class="w"> </span>will<span class="w"> </span>be
able<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>with<span class="w"> </span>DPDK<span class="w"> </span>and<span class="w"> </span>VFIO<span class="w"> </span><span class="k">if</span><span class="w"> </span>run<span class="w"> </span>as<span class="w"> </span>current<span class="w"> </span>user.
To<span class="w"> </span>change<span class="w"> </span>this,<span class="w"> </span>please<span class="w"> </span>adjust<span class="w"> </span>limits.conf<span class="w"> </span>memlock<span class="w"> </span>limit<span class="w"> </span><span class="k">for</span><span class="w"> </span>current<span class="w"> </span>user.
</pre></div>
</div>
<p>To unbind from <code class="docutils literal notranslate"><span class="pre">vfio-pci</span></code> and back to the Kernel NVMe driver, then run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme-driver<span class="w"> </span>reset
</pre></div>
</div>
<p>Should output similar to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">0000</span>:03:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>vfio-pci<span class="w"> </span>-&gt;<span class="w"> </span>nvme
<span class="m">0000</span>:04:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>vfio-pci<span class="w"> </span>-&gt;<span class="w"> </span>nvme
<span class="m">0000</span>:05:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>vfio-pci<span class="w"> </span>-&gt;<span class="w"> </span>nvme
<span class="m">0000</span>:06:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>vfio-pci<span class="w"> </span>-&gt;<span class="w"> </span>nvme
<span class="m">0000</span>:00:02.0<span class="w"> </span><span class="o">(</span>1af4<span class="w"> </span><span class="m">1001</span><span class="o">)</span>:<span class="w"> </span>Already<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>virtio-pci<span class="w"> </span>driver
</pre></div>
</div>
</section>
<section id="device-identifiers">
<span id="sec-device-identifiers"></span><h4>Device Identifiers<a class="headerlink" href="#device-identifiers" title="Link to this heading"></a></h4>
<p>Since the Kernel NVMe driver is unbound from the device, then the kernel no
longer know that the PCIe device is an NVMe device, thus, it no longer lives in
Linux devfs, that is, no longer available in <code class="docutils literal notranslate"><span class="pre">/dev</span></code> as e.g. <code class="docutils literal notranslate"><span class="pre">/dev/nvme0n1</span></code>.</p>
<p>Instead of the filepath in devfs, then you use PCI ids and xNVMe options.</p>
<p>As always, use the <code class="docutils literal notranslate"><span class="pre">xnvme</span></code> cli tool to enumerate devices:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme<span class="w"> </span>enum
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_cli_enumeration:
<span class="w">  </span>-<span class="w"> </span><span class="o">{</span>uri:<span class="w"> </span><span class="s1">&#39;0000:04:00.0&#39;</span>,<span class="w"> </span>dtype:<span class="w"> </span>0x2,<span class="w"> </span>nsid:<span class="w"> </span>0x1,<span class="w"> </span>csi:<span class="w"> </span>0x0,<span class="w"> </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:adcdbeef&#39;</span><span class="o">}</span>
<span class="w">  </span>-<span class="w"> </span><span class="o">{</span>uri:<span class="w"> </span><span class="s1">&#39;0000:05:00.0&#39;</span>,<span class="w"> </span>dtype:<span class="w"> </span>0x2,<span class="w"> </span>nsid:<span class="w"> </span>0x1,<span class="w"> </span>csi:<span class="w"> </span>0x0,<span class="w"> </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:beefcace&#39;</span><span class="o">}</span>
<span class="w">  </span>-<span class="w"> </span><span class="o">{</span>uri:<span class="w"> </span><span class="s1">&#39;0000:06:00.0&#39;</span>,<span class="w"> </span>dtype:<span class="w"> </span>0x2,<span class="w"> </span>nsid:<span class="w"> </span>0x1,<span class="w"> </span>csi:<span class="w"> </span>0x0,<span class="w"> </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:subsys0&#39;</span><span class="o">}</span>
<span class="w">  </span>-<span class="w"> </span><span class="o">{</span>uri:<span class="w"> </span><span class="s1">&#39;0000:03:00.0&#39;</span>,<span class="w"> </span>dtype:<span class="w"> </span>0x2,<span class="w"> </span>nsid:<span class="w"> </span>0x1,<span class="w"> </span>csi:<span class="w"> </span>0x0,<span class="w"> </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:deadbeef&#39;</span><span class="o">}</span>
<span class="w">  </span>-<span class="w"> </span><span class="o">{</span>uri:<span class="w"> </span><span class="s1">&#39;0000:03:00.0&#39;</span>,<span class="w"> </span>dtype:<span class="w"> </span>0x2,<span class="w"> </span>nsid:<span class="w"> </span>0x2,<span class="w"> </span>csi:<span class="w"> </span>0x2,<span class="w"> </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:deadbeef&#39;</span><span class="o">}</span>
<span class="w">  </span>-<span class="w"> </span><span class="o">{</span>uri:<span class="w"> </span><span class="s1">&#39;0000:03:00.0&#39;</span>,<span class="w"> </span>dtype:<span class="w"> </span>0x2,<span class="w"> </span>nsid:<span class="w"> </span>0x3,<span class="w"> </span>csi:<span class="w"> </span>0x1,<span class="w"> </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:deadbeef&#39;</span><span class="o">}</span>
</pre></div>
</div>
<p>Notice that multiple URIs using the same PCI id but with different <strong>xNVMe</strong>
<code class="docutils literal notranslate"><span class="pre">?opts=&lt;val&gt;</span></code>. This is provided as a means to tell <strong>xNVMe</strong> that you want to
use the NVMe controller at <code class="docutils literal notranslate"><span class="pre">0000:03:00.0</span></code> and the namespace identified by
<code class="docutils literal notranslate"><span class="pre">nsid=1</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme-driver
xnvme<span class="w"> </span>info<span class="w"> </span><span class="m">0000</span>:03:00.0<span class="w"> </span>--dev-nsid<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">0000</span>:03:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>Already<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>vfio-pci<span class="w"> </span>driver
<span class="m">0000</span>:04:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>Already<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>vfio-pci<span class="w"> </span>driver
<span class="m">0000</span>:05:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>Already<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>vfio-pci<span class="w"> </span>driver
<span class="m">0000</span>:06:00.0<span class="w"> </span><span class="o">(</span>1b36<span class="w"> </span><span class="m">0010</span><span class="o">)</span>:<span class="w"> </span>Already<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>vfio-pci<span class="w"> </span>driver
<span class="m">0000</span>:00:02.0<span class="w"> </span><span class="o">(</span>1af4<span class="w"> </span><span class="m">1001</span><span class="o">)</span>:<span class="w"> </span>Active<span class="w"> </span>mountpoints<span class="w"> </span>on<span class="w"> </span>/dev/vda,<span class="w"> </span>so<span class="w"> </span>not<span class="w"> </span>binding

Current<span class="w"> </span>user<span class="w"> </span>memlock<span class="w"> </span>limit:<span class="w"> </span><span class="m">743</span><span class="w"> </span>MB

This<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>maximum<span class="w"> </span>amount<span class="w"> </span>of<span class="w"> </span>memory<span class="w"> </span>you<span class="w"> </span>will<span class="w"> </span>be
able<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>with<span class="w"> </span>DPDK<span class="w"> </span>and<span class="w"> </span>VFIO<span class="w"> </span><span class="k">if</span><span class="w"> </span>run<span class="w"> </span>as<span class="w"> </span>current<span class="w"> </span>user.
To<span class="w"> </span>change<span class="w"> </span>this,<span class="w"> </span>please<span class="w"> </span>adjust<span class="w"> </span>limits.conf<span class="w"> </span>memlock<span class="w"> </span>limit<span class="w"> </span><span class="k">for</span><span class="w"> </span>current<span class="w"> </span>user.


xnvme_dev:
<span class="w">  </span>xnvme_ident:
<span class="w">    </span>uri:<span class="w"> </span><span class="s1">&#39;0000:03:00.0&#39;</span>
<span class="w">    </span>dtype:<span class="w"> </span>0x2
<span class="w">    </span>nsid:<span class="w"> </span>0x1
<span class="w">    </span>csi:<span class="w"> </span>0x0
<span class="w">    </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:deadbeef&#39;</span>
<span class="w">  </span>xnvme_be:
<span class="w">    </span>admin:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>async:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>attr:<span class="w"> </span><span class="o">{</span>name:<span class="w"> </span><span class="s1">&#39;spdk&#39;</span><span class="o">}</span>
<span class="w">  </span>xnvme_opts:
<span class="w">    </span>be:<span class="w"> </span><span class="s1">&#39;spdk&#39;</span>
<span class="w">    </span>mem:<span class="w"> </span><span class="s1">&#39;spdk&#39;</span>
<span class="w">    </span>dev:<span class="w"> </span><span class="s1">&#39;FIX-ID-VS-MIXIN-NAME&#39;</span>
<span class="w">    </span>admin:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span>
<span class="w">    </span>async:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span>
<span class="w">  </span>xnvme_geo:
<span class="w">    </span>type:<span class="w"> </span>XNVME_GEO_CONVENTIONAL
<span class="w">    </span>npugrp:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>npunit:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>nzone:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>nsect:<span class="w"> </span><span class="m">2097152</span>
<span class="w">    </span>nbytes:<span class="w"> </span><span class="m">4096</span>
<span class="w">    </span>nbytes_oob:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>tbytes:<span class="w"> </span><span class="m">8589934592</span>
<span class="w">    </span>mdts_nbytes:<span class="w"> </span><span class="m">524288</span>
<span class="w">    </span>lba_nbytes:<span class="w"> </span><span class="m">4096</span>
<span class="w">    </span>lba_extended:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>ssw:<span class="w"> </span><span class="m">12</span>
</pre></div>
</div>
<p>Similarly, when using the API, then you would use these URIs instead of
filepaths:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">struct</span> <span class="n">xnvme_dev</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="n">xnvme_dev_open</span><span class="p">(</span><span class="s2">&quot;pci:0000:01:00.0?nsid=1&quot;</span><span class="p">);</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="windows-kernel">
<span id="sec-building-example"></span><h3>Windows Kernel<a class="headerlink" href="#windows-kernel" title="Link to this heading"></a></h3>
<p>Windows 10 or later version is currently preferred as it has all the features
which <strong>xNVMe</strong> utilizes. This section also gives you a brief overview of the
different I/O paths and APIs which the <strong>xNVMe</strong> API unifies access to.</p>
<section id="id1">
<h4>NVMe Driver and IOCTLs<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<p>The default for <strong>xNVMe</strong> is to communicate with devices via the operating
system NVMe driver IOCTLs, specifically on Windows the following are used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IOCTL_STORAGE_QUERY_PROPERTY</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IOCTL_STORAGE_SET_PROPERTY</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IOCTL_STORAGE_REINITIALIZE_MEDIA</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IOCTL_SCSI_PASS_THROUGH_DIRECT</span></code></p></li>
</ul>
<p>You can check that this interface is behaving as expected by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme.exe<span class="w"> </span>info<span class="w"> </span><span class="se">\\</span>.<span class="se">\P</span>hysicalDrive0
</pre></div>
</div>
<p>Which should yield output equivalent to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_dev:
<span class="w">  </span>xnvme_ident:
<span class="w">    </span>uri:<span class="w"> </span><span class="s1">&#39;\\.\PhysicalDrive0&#39;</span>
<span class="w">    </span>dtype:<span class="w"> </span>0x2
<span class="w">    </span>nsid:<span class="w"> </span>0x1
<span class="w">    </span>csi:<span class="w"> </span>0x0
<span class="w">    </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.1994-11.com.samsung:nvme:980M.2:S649NL0T973010L     &#39;</span>
<span class="w">  </span>xnvme_be:
<span class="w">    </span>admin:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>async:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;iocp&#39;</span><span class="o">}</span>
<span class="w">    </span>attr:<span class="w"> </span><span class="o">{</span>name:<span class="w"> </span><span class="s1">&#39;windows&#39;</span><span class="o">}</span>
</pre></div>
</div>
<p>This tells you that <strong>xNVMe</strong> can communicate with the given device identifier
and it informs you that it utilizes <strong>nvme_ioctl</strong> for synchronous command
execution and it uses <strong>iocp</strong> for asynchronous command execution. This method
can be used for raw devices via <strong>\.PhysicalDrive&lt;disk number&gt;</strong> device path.</p>
<p>Below mentioned commands are currently supported by <strong>xNVMe</strong> using IOCTL path:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Admin</span> <span class="pre">Commands</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Log</span> <span class="pre">Page</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Identify</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Feature</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Format</span> <span class="pre">NVM</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">I/O</span> <span class="pre">Commands</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Read</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Write</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="nvme-driver-and-regular-file">
<h4>NVMe Driver and Regular File<a class="headerlink" href="#nvme-driver-and-regular-file" title="Link to this heading"></a></h4>
<p><strong>xNVMe</strong> can communicate with File System mounted devices via the operating
system generic APIs like <strong>ReadFile</strong> and <strong>WriteFile</strong> operations. This method
can be used to do operation on Regular Files.</p>
<p>You can check that this interface is behaving as expected by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme.exe<span class="w"> </span>info<span class="w"> </span>C:<span class="se">\R</span>EADME.md
</pre></div>
</div>
<p>Which should yield output equivalent to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_dev:
<span class="w">  </span>xnvme_ident:
<span class="w">    </span>uri:<span class="w"> </span><span class="s1">&#39;C:\README.md&#39;</span>
<span class="w">    </span>dtype:<span class="w"> </span>0x4
<span class="w">    </span>nsid:<span class="w"> </span>0x1
<span class="w">    </span>csi:<span class="w"> </span>0x1f
<span class="w">    </span>subnqn:<span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">  </span>xnvme_be:
<span class="w">    </span>admin:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;file&#39;</span><span class="o">}</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;file&#39;</span><span class="o">}</span>
<span class="w">    </span>async:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;iocp&#39;</span><span class="o">}</span>
<span class="w">    </span>attr:<span class="w"> </span><span class="o">{</span>name:<span class="w"> </span><span class="s1">&#39;windows&#39;</span><span class="o">}</span>
</pre></div>
</div>
<p>This tells you that <strong>xNVMe</strong> can communicate with the given regular file
and it informs you that it utilizes <strong>nvme_ioctl</strong> for synchronous command
execution and it uses <strong>iocp</strong> for asynchronous command execution. This method
can be used for file operations via <strong>&lt;driver name&gt;:&lt;file name&gt;</strong> path.</p>
</section>
<section id="async-i-o-via-iocp">
<h4>Async I/O via <code class="docutils literal notranslate"><span class="pre">iocp</span></code><a class="headerlink" href="#async-i-o-via-iocp" title="Link to this heading"></a></h4>
<p>When AIO is available then the NVMe NVM Commands for <strong>read</strong> and <strong>write</strong> are
sent over the Windows IOCP interface. Doing so improves command-throughput at
higher queue-depths when compared to sending the command via the NVMe driver
ioctl().</p>
<p>One can explicitly tell <strong>xNVMe</strong> to utilize <code class="docutils literal notranslate"><span class="pre">iocp</span></code> for async I/O by
encoding it in the device identifier, like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_io_async<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="se">\\</span>.<span class="se">\P</span>hysicalDrive0<span class="w"> </span>--slba<span class="w"> </span>0x0<span class="w"> </span>--qdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--async<span class="w"> </span>iocp
</pre></div>
</div>
<p>Yielding the output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Allocating and filling buf of nbytes: 512</span>
<span class="c1"># Initializing queue and setting default callback function and arguments</span>
<span class="c1"># Read uri: &#39;\\.\PhysicalDrive0&#39;, qd: 1</span>
xnvme_lba_range:
<span class="w">  </span>slba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>elba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>naddrs:<span class="w"> </span><span class="m">1</span>
<span class="w">  </span>nbytes:<span class="w"> </span><span class="m">512</span>
<span class="w">  </span>attr:<span class="w"> </span><span class="o">{</span><span class="w"> </span>is_zones:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>is_valid:<span class="w"> </span><span class="m">1</span><span class="o">}</span>
wall-clock:<span class="w"> </span><span class="o">{</span>elapsed:<span class="w"> </span><span class="m">0</span>.0002,<span class="w"> </span>mib:<span class="w"> </span><span class="m">0</span>.00,<span class="w"> </span>mib_sec:<span class="w"> </span><span class="m">2</span>.08<span class="o">}</span>
<span class="c1"># cb_args: {submitted: 1, completed: 1, ecount: 0}</span>
</pre></div>
</div>
</section>
<section id="async-i-o-via-iocp-th">
<h4>Async I/O via <code class="docutils literal notranslate"><span class="pre">iocp_th</span></code><a class="headerlink" href="#async-i-o-via-iocp-th" title="Link to this heading"></a></h4>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">iocp</span></code> interface, only difference is separate poller is used to
fetch the completed IOs.</p>
<p>One can explicitly tell <strong>xNVMe</strong> to utilize <code class="docutils literal notranslate"><span class="pre">iocp_th</span></code> for async I/O by
encoding it in the device identifier, like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_io_async<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="se">\\</span>.<span class="se">\P</span>hysicalDrive0<span class="w"> </span>--slba<span class="w"> </span>0x0<span class="w"> </span>--qdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--async<span class="w"> </span>iocp_th
</pre></div>
</div>
<p>Yielding the output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Allocating and filling buf of nbytes: 512</span>
<span class="c1"># Initializing queue and setting default callback function and arguments</span>
<span class="c1"># Read uri: &#39;\\.\PhysicalDrive0&#39;, qd: 1</span>
xnvme_lba_range:
<span class="w">  </span>slba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>elba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>naddrs:<span class="w"> </span><span class="m">1</span>
<span class="w">  </span>nbytes:<span class="w"> </span><span class="m">512</span>
<span class="w">  </span>attr:<span class="w"> </span><span class="o">{</span><span class="w"> </span>is_zones:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>is_valid:<span class="w"> </span><span class="m">1</span><span class="o">}</span>
wall-clock:<span class="w"> </span><span class="o">{</span>elapsed:<span class="w"> </span><span class="m">0</span>.0002,<span class="w"> </span>mib:<span class="w"> </span><span class="m">0</span>.00,<span class="w"> </span>mib_sec:<span class="w"> </span><span class="m">2</span>.14<span class="o">}</span>
<span class="c1"># cb_args: {submitted: 1, completed: 1, ecount: 0}</span>
</pre></div>
</div>
</section>
<section id="async-i-o-via-io-ring">
<h4>Async I/O via <code class="docutils literal notranslate"><span class="pre">io_ring</span></code><a class="headerlink" href="#async-i-o-via-io-ring" title="Link to this heading"></a></h4>
<p><strong>xNVMe</strong> utilizes the Windows <strong>io_ring</strong> interface, its support for
feature-probing the <strong>io_ring</strong> interface and the <strong>io_ring</strong> opcodes:</p>
<p>When available, then <strong>xNVMe</strong> can send the <strong>io_ring</strong> specific request using
<strong>IORING_HANDLE_REF</strong> and <strong>IORING_BUFFER_REF</strong> structure for <strong>read</strong> and
<strong>write</strong> via Windows <strong>io_ring</strong> interface. Doing so improves command-throughput
at all io-depths when compared to sending the command via NVMe Driver IOCTLs.</p>
<p>One can explicitly tell <strong>xNVMe</strong> to utilize <code class="docutils literal notranslate"><span class="pre">io_ring</span></code> for async I/O by
encoding it in the device identifier, like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_io_async<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="se">\\</span>.<span class="se">\P</span>hysicalDrive0<span class="w"> </span>--slba<span class="w"> </span>0x0<span class="w"> </span>--qdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--async<span class="w"> </span>io_ring
</pre></div>
</div>
<p>Yielding the output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Allocating and filling buf of nbytes: 512</span>
<span class="c1"># Initializing queue and setting default callback function and arguments</span>
<span class="c1"># Read uri: &#39;\\.\PhysicalDrive0&#39;, qd: 1</span>
xnvme_lba_range:
<span class="w">  </span>slba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>elba:<span class="w"> </span>0x0000000000000000
<span class="w">  </span>naddrs:<span class="w"> </span><span class="m">1</span>
<span class="w">  </span>nbytes:<span class="w"> </span><span class="m">512</span>
<span class="w">  </span>attr:<span class="w"> </span><span class="o">{</span><span class="w"> </span>is_zones:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>is_valid:<span class="w"> </span><span class="m">1</span><span class="o">}</span>
wall-clock:<span class="w"> </span><span class="o">{</span>elapsed:<span class="w"> </span><span class="m">0</span>.0003,<span class="w"> </span>mib:<span class="w"> </span><span class="m">0</span>.00,<span class="w"> </span>mib_sec:<span class="w"> </span><span class="m">1</span>.92<span class="o">}</span>
<span class="c1"># cb_args: {submitted: 1, completed: 1, ecount: 0}</span>
</pre></div>
</div>
</section>
</section>
<section id="building-spdk-backend-on-windows">
<h3>Building SPDK backend on Windows<a class="headerlink" href="#building-spdk-backend-on-windows" title="Link to this heading"></a></h3>
<p><strong>SPDK</strong> can be used as a backend for <strong>xNVMe</strong>, to leverage this interface
first user need to compile the <strong>SPDK</strong> as a subproject with <strong>xNVMe</strong> its
depend on Windows Platform Development Kit (WPDK) that help to enables
applications based on the Storage Performance Development Kit (SPDK) to
build and run as native Windows executables.</p>
<section id="prerequisites-to-compile-the-spdk">
<h4>Prerequisite’s to compile the <code class="docutils literal notranslate"><span class="pre">SPDK</span></code><a class="headerlink" href="#prerequisites-to-compile-the-spdk" title="Link to this heading"></a></h4>
<p>Refer below mentioned script and link to install the dependencies packages,</p>
<ul>
<li><dl>
<dt>MinGW cross compiler and libraries</dt><dd><p>this can be installed by running below script,</p>
<div class="highlight-batch notranslate"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">echo</span> off
<span class="p">@</span><span class="k">setlocal</span> enableextensions enabledelayedexpansion

net session <span class="p">&gt;</span>nul: <span class="mi">2</span><span class="p">&gt;&amp;</span><span class="mi">1</span>
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> <span class="nv">%0</span> must be run with Administrator privileges
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>

<span class="p">:</span><span class="c1">: Use PowerShell to install Chocolatey</span>
<span class="k">set</span> <span class="s2">&quot;PATH=</span><span class="nv">%ALLUSERSPROFILE%</span><span class="s2">\chocolatey\bin;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
<span class="k">echo</span> [1/6] Install: Chocolatey Manager
powershell -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command <span class="s2">&quot;[System.Net.ServicePointManager]::SecurityProtocol = 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;))&quot;</span>
where /q choco
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> [1/6] Install: Chocolatey = FAIL
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>
<span class="k">echo</span> [1/6] Install: Chocolatey = PASS

<span class="p">:</span><span class="c1">: Use Chocolatey to install msys2</span>
<span class="k">echo</span> [2/6] Install: MSYS2
<span class="k">set</span> <span class="s2">&quot;PATH=</span><span class="nv">%SystemDrive%</span><span class="s2">\msys64;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
choco install msys2 -y -r --params <span class="s2">&quot;/NoUpdate /InstallDir:C:\msys64&quot;</span>
where /q msys2
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> [2/6] Install: MSYS2 = FAIL
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>
<span class="k">echo</span> [2/6] Install: MSYS2 = PASS

<span class="k">echo</span> [3/6] Install: Git
choco install git -y -r
<span class="k">echo</span> [3/6] Install: Git = PASS

<span class="k">echo</span> [4/6] Install: dos2unix
choco install dos2unix
<span class="k">echo</span> [4/6] Install: dos2unix = PASS

<span class="p">:</span><span class="c1">: Use MSYS2/pacman to install gcc and clang toolchain</span>
<span class="k">set</span> <span class="nv">MSYS2</span><span class="p">=</span>call msys2_shell -no-start -here -use-full-path -defterm

<span class="k">echo</span> [5/6] Install: MinGW Toolchain via msys2/pacman
<span class="k">set</span> <span class="s2">&quot;PATH=</span><span class="nv">%SystemDrive%</span><span class="s2">\msys64\mingw64\bin;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
<span class="nv">%MSYS2%</span> -c <span class="s2">&quot;pacman --noconfirm -Syy --needed base-devel mingw-w64-x86_64-toolchain&quot;</span>
where /q gcc
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="p">(</span>
	<span class="k">echo</span> [5/6] Install: MinGW Toolchain via msys2/pacman = FAIL
	<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>
<span class="p">)</span>
<span class="k">echo</span> [5/6] Install: MinGW Toolchain via msys2/pacman = PASS

<span class="k">echo</span> [6/6] Install: MinGW/meson via msys2/pacman
<span class="nv">%MSYS2%</span> -c <span class="s2">&quot;pacman --noconfirm -Syy mingw-w64-x86_64-meson&quot;</span>
<span class="k">echo</span> [6/6] Install: MinGW/meson via msys2/pacman = OK
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p><a href="#id3"><span class="problematic" id="id4">`Windows Subsystem of Linux (WSL)`_</span></a></p></li>
</ul>
</section>
<section id="compilation-and-installation">
<h4>Compilation and Installation<a class="headerlink" href="#compilation-and-installation" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Configure, build and install using helper batch script <code class="docutils literal notranslate"><span class="pre">build.bat</span></code>:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1"># build: auto-configure xNVMe, build third-party libraries, and xNVMe itself</span>
<span class="w">  </span>build.bat

<span class="w">  </span><span class="c1"># config: only configure xNVMe</span>
<span class="w">  </span>build.bat<span class="w"> </span>config

<span class="w">  </span><span class="c1"># config: debug only configure xNVMe</span>
<span class="w">  </span>build.bat<span class="w"> </span>config-debug

<span class="w">  </span><span class="c1"># install xNVMe</span>
<span class="w">  </span>build.bat<span class="w"> </span>install

<span class="w">  </span><span class="c1"># uninstall xNVMe</span>
<span class="w">  </span><span class="c1"># build.bat uninstall</span>
</pre></div>
</div>
</section>
<section id="runtime-prerequisites">
<h4>Runtime Prerequisite’s<a class="headerlink" href="#runtime-prerequisites" title="Link to this heading"></a></h4>
<p>Refer below mentioned DPDK links to resolve runtime dependencies,</p>
<ul class="simple">
<li><p><a href="#id5"><span class="problematic" id="id6">`Grant Lock pages in memory Privilege`_</span></a></p></li>
</ul>
<ul class="simple">
<li><p><a href="#id7"><span class="problematic" id="id8">`Download DPDK kmods-driver`_</span></a></p></li>
</ul>
<ul class="simple">
<li><p><a href="#id9"><span class="problematic" id="id10">`Install virt2phys`_</span></a></p></li>
</ul>
<ul class="simple">
<li><p><a href="#id11"><span class="problematic" id="id12">`Install NetUIO`_</span></a></p></li>
</ul>
</section>
</section>
</section>
<section id="building-an-xnvme-program">
<h2>Building an xNVMe Program<a class="headerlink" href="#building-an-xnvme-program" title="Link to this heading"></a></h2>
<p>At this point you should have <strong>xNVMe</strong> built and installed on your system and
have the system correctly configured and you should by now also be familiar
with how to instrument <strong>xNVMe</strong> to utilize different backends and backend
options.</p>
<p>With all that in place, go ahead and compile your own <strong>xNVMe</strong> program.</p>
<section id="example-code">
<h3>Example code<a class="headerlink" href="#example-code" title="Link to this heading"></a></h3>
<p>This <cite>“hello-world”</cite> example prints out device information of the NVMe
device at <code class="docutils literal notranslate"><span class="pre">/dev/nvme0n1</span></code>.</p>
<p>To use <strong>xNVMe</strong> include the <code class="docutils literal notranslate"><span class="pre">libxnvme.h</span></code> header in your C/C++ source:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;libxnvme.h&gt;</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">struct</span><span class="w"> </span><span class="nc">xnvme_opts</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xnvme_opts_default</span><span class="p">();</span>
<span class="w">	</span><span class="k">struct</span><span class="w"> </span><span class="nc">xnvme_dev</span><span class="w"> </span><span class="o">*</span><span class="n">dev</span><span class="p">;</span>

<span class="w">	</span><span class="n">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xnvme_dev_open</span><span class="p">(</span><span class="s">&quot;/dev/nvme0n1&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">opts</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">dev</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;xnvme_dev_open()&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">xnvme_dev_pr</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">XNVME_PR_DEF</span><span class="p">);</span>
<span class="w">	</span><span class="n">xnvme_dev_close</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="compile-and-link">
<h3>Compile and link<a class="headerlink" href="#compile-and-link" title="Link to this heading"></a></h3>
<p>A pkg-config is provided with xNVMe, you can use <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code> to get the
required linker flags:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pkg-config<span class="w"> </span>--libs<span class="w"> </span>xnvme
</pre></div>
</div>
<p>This will output something like the output below, it will vary depending on the
features enabled/disabled.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-L/usr/local/lib/x86_64-linux-gnu<span class="w"> </span>-lxnvme
</pre></div>
</div>
<p>You can pass the arguments above to your compiler, or using pkg-config like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcc<span class="w"> </span>../getting_started/hello.c<span class="w">  </span><span class="k">$(</span>pkg-config<span class="w"> </span>--libs<span class="w"> </span>xnvme<span class="k">)</span><span class="w"> </span>-o<span class="w"> </span>hello
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You do not need to link with SPDK/DPDK, as these are bundled
with <strong>xNVMe</strong>. However, do take note of the linker flags surrounding
<code class="docutils literal notranslate"><span class="pre">-lxnvme</span></code>, these are required as SPDK makes use of
<code class="docutils literal notranslate"><span class="pre">__attribute__((constructor))</span></code>. Without the linker flags, none of the SPDK
transports will work, as <strong>ctors</strong> will be “linked-out”, and <strong>xNVMe</strong> will
give you errors such as <strong>device not found</strong>.</p>
</div>
<p>Also, <strong>xNVMe</strong> provides two different libraries, a static, and a shared
library as well. Here is what the different libraries are intended for:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">libxnvme.a</span></code>, this is static library version of <strong>xNVMe</strong> except it does
<strong>not</strong> come with <strong>batteries included</strong>, so you have to manually link with
SPDK, liburing, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">libxnvme.so</span></code>, this is the shared library version of <strong>xNVMe</strong> and it comes
with <strong>batteries included</strong>, that is, all the third-party libraries are bundled
within the shared library <code class="docutils literal notranslate"><span class="pre">libxnvme.so</span></code>. Thus you only need to link with
<strong>xNVMe</strong>, as described above, and need not worry about linking with SPDK,
liburing etc.</p></li>
</ul>
<p>Using <code class="docutils literal notranslate"><span class="pre">libxnvme.so</span></code> is the preferred way to consume <strong>xNVMe</strong> as it comes with
the correct version of the various third-party libraries and provides for
a simpler link-target.</p>
</section>
<section id="run">
<h3>Run!<a class="headerlink" href="#run" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chmod<span class="w"> </span>+x<span class="w"> </span>hello
./hello
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xnvme_dev:
<span class="w">  </span>xnvme_ident:
<span class="w">    </span>uri:<span class="w"> </span><span class="s1">&#39;/dev/nvme0n1&#39;</span>
<span class="w">    </span>dtype:<span class="w"> </span>0x2
<span class="w">    </span>nsid:<span class="w"> </span>0x1
<span class="w">    </span>csi:<span class="w"> </span>0x0
<span class="w">    </span>subnqn:<span class="w"> </span><span class="s1">&#39;nqn.2019-08.org.qemu:deadbeef&#39;</span>
<span class="w">  </span>xnvme_be:
<span class="w">    </span>admin:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span><span class="o">}</span>
<span class="w">    </span>async:<span class="w"> </span><span class="o">{</span>id:<span class="w"> </span><span class="s1">&#39;emu&#39;</span><span class="o">}</span>
<span class="w">    </span>attr:<span class="w"> </span><span class="o">{</span>name:<span class="w"> </span><span class="s1">&#39;linux&#39;</span><span class="o">}</span>
<span class="w">  </span>xnvme_opts:
<span class="w">    </span>be:<span class="w"> </span><span class="s1">&#39;linux&#39;</span>
<span class="w">    </span>mem:<span class="w"> </span><span class="s1">&#39;posix&#39;</span>
<span class="w">    </span>dev:<span class="w"> </span><span class="s1">&#39;FIX-ID-VS-MIXIN-NAME&#39;</span>
<span class="w">    </span>admin:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span>
<span class="w">    </span>sync:<span class="w"> </span><span class="s1">&#39;nvme&#39;</span>
<span class="w">    </span>async:<span class="w"> </span><span class="s1">&#39;emu&#39;</span>
<span class="w">  </span>xnvme_geo:
<span class="w">    </span>type:<span class="w"> </span>XNVME_GEO_CONVENTIONAL
<span class="w">    </span>npugrp:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>npunit:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>nzone:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>nsect:<span class="w"> </span><span class="m">2097152</span>
<span class="w">    </span>nbytes:<span class="w"> </span><span class="m">4096</span>
<span class="w">    </span>nbytes_oob:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>tbytes:<span class="w"> </span><span class="m">8589934592</span>
<span class="w">    </span>mdts_nbytes:<span class="w"> </span><span class="m">520192</span>
<span class="w">    </span>lba_nbytes:<span class="w"> </span><span class="m">4096</span>
<span class="w">    </span>lba_extended:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>ssw:<span class="w"> </span><span class="m">12</span>
</pre></div>
</div>
<p>This should conclude the getting started guide of <strong>xNVMe</strong>, go ahead and
explore the <a class="reference internal" href="../tools/index.html#sec-tools"><span class="std std-ref">Tools</span></a>, <a class="reference internal" href="../capis/index.html#sec-c-api"><span class="std std-ref">C API</span></a>, and <a class="reference internal" href="../examples/index.html#sec-examples"><span class="std std-ref">C API: Examples</span></a>.</p>
<p>Should <strong>xNVMe</strong> or your system still be misbehaving, then take a look in the
<a class="reference internal" href="#sec-troubleshooting"><span class="std std-ref">Troubleshooting</span></a> section or reach out by raising an <a class="reference external" href="https://github.com/OpenMPDK/xNVMe/issues">issue</a>, start an
asynchronous <a class="reference external" href="https://github.com/OpenMPDK/xNVMe/discussions">discussion</a>, or go to <a class="reference external" href="https://discord.com/invite/XCbBX9DmKf">Discord</a> for synchronous interaction.</p>
</section>
</section>
<section id="troubleshooting">
<span id="sec-troubleshooting"></span><h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
<section id="id2">
<h3>User space<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>In case you are having issues using SPDK backend then make sure you are
following the config section <a class="reference internal" href="#sec-gs-system-config-userspace-config"><span class="std std-ref">Config</span></a> and
if issues persist a solution might be found in the following subsections.</p>
<section id="no-devices-found">
<h4>No devices found<a class="headerlink" href="#no-devices-found" title="Link to this heading"></a></h4>
<p>When running <code class="docutils literal notranslate"><span class="pre">xnvme</span> <span class="pre">enum</span></code> and the output-listing is empty, then there are no
devices. When running with <code class="docutils literal notranslate"><span class="pre">vfio-pci</span></code>, this can occur when your devices are
sharing iommu-group with other devices which are still bound to in-kernel
drivers. This could be NICs, GPUs or other kinds of peripherals.</p>
<p>The division of devices into groups is not something that can be easily
switched, but you can try to manually unbind the other devices in the iommu
group from their kernel drivers.</p>
<p>If that is not an option then you can try to re-organize your physical
connectivity of deviecs, e.g. move devices around.</p>
<p>Lastly you can try using <code class="docutils literal notranslate"><span class="pre">uio_pci_generic</span></code> instead, this can most easily be
done by disabling iommu by adding the kernel option: <code class="docutils literal notranslate"><span class="pre">iommu=off</span></code> to the
kernel command-line and rebooting.</p>
</section>
<section id="memory-issues">
<h4>Memory Issues<a class="headerlink" href="#memory-issues" title="Link to this heading"></a></h4>
<p>If you see a message similar to the below while unbinding devices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Current</span> <span class="n">user</span> <span class="n">memlock</span> <span class="n">limit</span><span class="p">:</span> <span class="mi">16</span> <span class="n">MB</span>

<span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">you</span> <span class="n">will</span> <span class="n">be</span>
<span class="n">able</span> <span class="n">to</span> <span class="n">use</span> <span class="k">with</span> <span class="n">DPDK</span> <span class="ow">and</span> <span class="n">VFIO</span> <span class="k">if</span> <span class="n">run</span> <span class="k">as</span> <span class="n">current</span> <span class="n">user</span><span class="o">.</span>
<span class="n">To</span> <span class="n">change</span> <span class="n">this</span><span class="p">,</span> <span class="n">please</span> <span class="n">adjust</span> <span class="n">limits</span><span class="o">.</span><span class="n">conf</span> <span class="n">memlock</span> <span class="n">limit</span> <span class="k">for</span> <span class="n">current</span> <span class="n">user</span><span class="o">.</span>

<span class="c1">## WARNING: memlock limit is less than 64MB</span>
<span class="c1">## DPDK with VFIO may not be able to initialize if run as current user.</span>
</pre></div>
</div>
<p>Then go you should do as suggested, that is, adjust <code class="docutils literal notranslate"><span class="pre">limits.conf</span></code>, for an
example, see <a class="reference internal" href="#sec-gs-system-config-userspace-config"><span class="std std-ref">Config</span></a>.</p>
</section>
</section>
<section id="build-errors">
<h3>Build Errors<a class="headerlink" href="#build-errors" title="Link to this heading"></a></h3>
<p>If you are getting errors while attempting to configure and build <strong>xNVMe</strong>
then it is likely due to one of the following:</p>
<ul class="simple">
<li><p>You are building in an <strong>offline</strong> environment and only have a shallow
source-archive or a git-repository without subprojects.</p></li>
</ul>
<p>The full source-archive is made available with each release and downloadable
from the <a class="reference external" href="https://github.com/OpenMPDK/xNVMe/releases">GitHUB Release page</a>
release page. It contains the xNVMe source code along with all the third-party
dependencies, namely: SPDK, liburing, libnvme, and fio.</p>
<p><strong>missing dependencies / toolchain</strong></p>
<ul class="simple">
<li><p>You are missing dependencies, see the <a class="reference internal" href="toolchain.html#sec-building-toolchain"><span class="std std-ref">Toolchain</span></a> for
installing these on FreeBSD and a handful of different Linux Distributions</p></li>
</ul>
<p>The <a class="reference internal" href="toolchain.html#sec-building-toolchain"><span class="std std-ref">Toolchain</span></a> section describes preferred ways of
installing libraries and tools. For example, on Ubuntu 18.04 it is preferred to
install <code class="docutils literal notranslate"><span class="pre">meson</span></code> via <code class="docutils literal notranslate"><span class="pre">pip3</span></code> since the version in the package registry is too
old for SPDK, thus if installed via the package manager then you will
experience build errors as the xNVMe build system starts building SPDK.</p>
<p>Once you have the full source of xNVMe, third-party library dependencies, and
setup the toolchain then run the following to ensure that the xNVMe repository
is clean from any artifacts left behind by previous build failures:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">clobber</span>
</pre></div>
</div>
<p>And then go back to the <a class="reference internal" href="#sec-building"><span class="std std-ref">Building xNVMe</span></a> and follow the steps there.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clobber</span></code> then everything not comitted is “lost”. Thus,
if you are developing/modifying xNVMe, then make you commit of stash your
changes before running it.</p>
</div>
</section>
<section id="known-build-issues">
<h3>Known Build Issues<a class="headerlink" href="#known-build-issues" title="Link to this heading"></a></h3>
<p>If the above did not sort out your build-issues, then you might be facing one
of the following known build-issues. If these do not apply to you, then please
post an issue on GitHUB describing your build environment and output from the
failed build.</p>
<p>When building <strong>xNVMe</strong> on <strong>Alpine Linux</strong> you might encounter some issues due
to musl standard library not being entirely compatible with <strong>GLIBC</strong> /
<strong>BSD</strong>.</p>
<p>The SPDK backend does not build on due to re-definition of <code class="docutils literal notranslate"><span class="pre">STAILQ_*</span></code>
macros. As a work-around, then disable the SPDK backend:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">meson</span> <span class="n">setup</span> <span class="n">builddir</span> <span class="o">-</span><span class="n">Dwith</span><span class="o">-</span><span class="n">spdk</span><span class="o">=</span><span class="n">false</span>
</pre></div>
</div>
<p>The Linux backend support for <code class="docutils literal notranslate"><span class="pre">io_uring</span></code> fails on <strong>Alpine Linux</strong> due to a
missing definition in <strong>musl</strong> leading to this error message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>include/liburing.h:195:17: error: unknown type name &#39;loff_t&#39;; did you mean
&#39;off_t&#39;?
</pre></div>
</div>
<p>As a work-around, then disable <code class="docutils literal notranslate"><span class="pre">io_uring</span></code> support:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">meson</span> <span class="n">setup</span> <span class="n">builddir</span> <span class="o">-</span><span class="n">Dwith</span><span class="o">-</span><span class="n">liburing</span><span class="o">=</span><span class="n">false</span>
</pre></div>
</div>
<p>See more details on changing the default build-configuration of <strong>xNVMe</strong> in
the section <a class="reference internal" href="#sec-building-config"><span class="std std-ref">Custom Configuration</span></a>.</p>
</section>
</section>
<section id="customizing-the-build">
<span id="sec-building-custom"></span><h2>Customizing the Build<a class="headerlink" href="#customizing-the-build" title="Link to this heading"></a></h2>
<section id="non-gcc-toolchain">
<span id="sec-building-custom-toolchain"></span><h3>Non-GCC Toolchain<a class="headerlink" href="#non-gcc-toolchain" title="Link to this heading"></a></h3>
<p>To use a compiler other than <strong>gcc</strong>, then:</p>
<ol class="arabic simple">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">CC</span></code> and <code class="docutils literal notranslate"><span class="pre">CXX</span></code> environment variable for the <code class="docutils literal notranslate"><span class="pre">./configure</span></code> script</p></li>
<li><p>Pass <code class="docutils literal notranslate"><span class="pre">CC</span></code>, and <code class="docutils literal notranslate"><span class="pre">CXX</span></code> as arguments to <code class="docutils literal notranslate"><span class="pre">make</span></code></p></li>
</ol>
<p>For example, compiling <strong>xNVMe</strong> on a system where the default compiler is not
<strong>gcc</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span><span class="o">=</span>gcc<span class="w"> </span><span class="nv">CXX</span><span class="o">=</span>g++<span class="w"> </span>./configure<span class="w"> </span>&lt;YOUR_OPTIONS_HERE&gt;
make<span class="w"> </span><span class="nv">CC</span><span class="o">=</span>gcc<span class="w"> </span><span class="nv">CXX</span><span class="o">=</span>g++
make<span class="w"> </span>install<span class="w"> </span><span class="nv">CC</span><span class="o">=</span>gcc<span class="w"> </span><span class="nv">CXX</span><span class="o">=</span>g++
</pre></div>
</div>
<p>Recent versions of <strong>icc</strong>, <strong>clang</strong>, and <strong>pgi</strong> should be able to satisfy
the <strong>C11</strong> and <strong>pthreads</strong> requirements. However, it will most likely require
a bit of fiddling.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>icc</strong> works well after you bought a license and installed it
correctly. There is a free option with Intel System Suite 2019.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>pgi</strong> compiler has some issues linking with <strong>SPDK/DPDK</strong> due
to unstable <strong>ABI</strong> for <strong>RTE</strong> it seems.</p>
</div>
<p>The path of least resistance is to just install the toolchain and libraries as
described in the <a class="reference internal" href="toolchain.html#sec-building-toolchain"><span class="std std-ref">Toolchain</span></a> section.</p>
</section>
<section id="custom-configuration">
<span id="sec-building-config"></span><h3>Custom Configuration<a class="headerlink" href="#custom-configuration" title="Link to this heading"></a></h3>
<p>See the list of options in <code class="docutils literal notranslate"><span class="pre">meson_options.txt</span></code>, this file defines the
different non-generic options that you can toggle. For traditional
build-configuration such as <code class="docutils literal notranslate"><span class="pre">--prefix</span></code> then these are managed like all other
meson-based builds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">meson</span> <span class="n">setup</span> <span class="n">builddir</span> <span class="o">-</span><span class="n">Dprefix</span><span class="o">=/</span><span class="n">foo</span><span class="o">/</span><span class="n">bar</span>
</pre></div>
</div>
<p>See: <a class="reference external" href="https://mesonbuild.com/Builtin-options.html">https://mesonbuild.com/Builtin-options.html</a></p>
<p>For details</p>
</section>
<section id="cross-compiling-for-arm-on-x86">
<span id="sec-building-crosscompiling"></span><h3>Cross-compiling for ARM on x86<a class="headerlink" href="#cross-compiling-for-arm-on-x86" title="Link to this heading"></a></h3>
<p>This is managed like any other meson-based build, see:</p>
<p><a class="reference external" href="https://mesonbuild.com/Cross-compilation.html">https://mesonbuild.com/Cross-compilation.html</a></p>
<p>for details</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Cross-platform libraries and tools for NVMe devices" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tools/index.html" class="btn btn-neutral float-right" title="Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, xNVMe.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-159785887-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-159785887-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>